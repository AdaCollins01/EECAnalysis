/*
 * Implementation of the EECBackgroundScale class
 */

// Own includes
#include "EECBackgroundScale.h"


/*
 * Contructor
 */
EECBackgroundScale::EECBackgroundScale(){
  InitializeArrays();
}

/*
 * Custom constructor
 *
 *  EECCard* card = Card from which it is determined if data is reconstructed or generator level
 *  const int iSystematic = Index for systematic uncertainty estimation for background subtraction.
 *                          0: Nominal results, no systematic uncertainty estimation
 *                          1: Systematic uncertainty derived from 2% centrality shifted simulation
 *                          2: Systematic uncertainty derived from 6% centrality shifted simulation
 */
EECBackgroundScale::EECBackgroundScale(EECCard* card, const int iSystematic){
  TString dataType = card->GetDataType();
  bool useGenJets = (dataType.Contains("GenReco") || dataType.Contains("GenGen"));
  InitializeArrays(useGenJets, iSystematic);
}

/*
 * Custom constructor
 *
 *  const bool useGenJets = Flag telling if we use scaling factors determined for reconstructed or generator level jets
 *  const int iSystematic = Index for systematic uncertainty estimation for background subtraction.
 *                          0: Nominal results, no systematic uncertainty estimation
 *                          1: Systematic uncertainty derived from 2% centrality shifted simulation
 *                          2: Systematic uncertainty derived from 6% centrality shifted simulation
 */
EECBackgroundScale::EECBackgroundScale(const bool useGenJets, const int iSystematic){
  InitializeArrays(useGenJets, iSystematic);
}

/*
 * Initialization for background scale arrays
 */
void EECBackgroundScale::InitializeArrays(const bool useGenJets, const int iSystematic){
  
  // ======================================================== //
  //                                                          //
  //  M     M   EEEEEE   TTTTTTT   H    H    OOOOO    DDDD    //
  //  MMM MMM   E           T      H    H   O     O   D   D   //
  //  M  M  M   EEEEEE      T      HHHHHH   O     O   D    D  //
  //  M     M   E           T      H    H   O     O   D   D   //
  //  M     M   EEEEEE      T      H    H    OOOOO    DDDD    //
  //                                                          //
  // ======================================================== //
  
  // In the current method, we start with Pythia+Hydjet simulation where the reconstructed jets are matched with the
  // generator level jets, and it is required that the matched jet has at least 50% of the reconstructed jet pT.
  // Since generator level jets are clustered only from Pythia particles, it can with large confidence say that
  // matched reconstructed jets are also Pythia jets, instead of jets coming from the Hydjet simulation.
  // When doing this matching, we can trust that the Hydjet particles are mostly background, and Pythia particles mostly signal.
  // We determine the true background from Pythia+Hydjet and Hydjet+Hydjet pairings from the signal cone.
  // The reflected cone background estimate is obtained by combining all particles from signal cone with all particles from the reflected cone.
  // We know that in this case fake+fake contribution is not properly modeled, but this contribution is negligible in the region
  // Track pT > 2 GeV and DeltaR < 0.4. We also know that there is a bias in reconstructing jets on upwards fluctuations of background.
  // To take the fluctuations into account and to mitigate the mismodeling of the fake+fake part, we look at the integrals of
  // true background and the reflected cone background estimate in the region DeltaR < 0.4 and calculate their ratio.
  // This ratio now reflects excess fluctuations below the jet peak in Monte Carlo. Assuming the ratio is similar in data,
  // the reflected cone estimate from data can be scaled with this number to get a good estimate of the absolute background level.
  //
  // The file that was used for the study is PbPbMC2018_RecoGen_eecAnalysis_akFlowJets_miniAOD_4pCentShift_noTrigger_cutBadPhi_finalMcWeight_matchJets_fixCentrality_processed_2023-03-06.root
  // The macro for the study is findBackgroundNormalizationScale.C
  // Git hash which produced these numbers is b6d4713c0216f54c5ef5f0632137575923442134
  
  double energyEnergyCorrelatorBackgroundScaleFactors[kNBackgroundScaleChoices][2][4][20][8] = 
  {

  // The first pair of arrays gives the parameters for the nominal result

  {
  // The first part of the array gives the results for reconstructed jets.
  // The file that was produced all the other numbers but the last two rows in each centrality bin is PbPbMC2018_RecoGen_eecAnalysis_akFlowJets_miniAOD_4pCentShift_noTrigger_cutBadPhi_matchJets_noJetPtWeight_processed_2023-05-26.root
  // The file that was used to produce the last two rows in each centrality bin is PbPbMC2018_RecoGen_eecAnalysis_akFlowJets_miniAOD_4pCentShift_noTrigger_cutBadPhi_finalMcWeight_matchJets_fixCentrality_processed_2023-03-06.root
  // The macro for the study is findBackgroundNormalizationScale.C
  // Git hash for all the other numbers except those in the last two rows is 4af9eb73e874758d159ccda143a265ed4abf29f1
  // Git hash which produced the numbers in the last two rows is b6d4713c0216f54c5ef5f0632137575923442134
  {

  // Centrality 0-10%
  {{1.39785,1.32176,1.20496,1.12722,1.09149,1.09222,1.12055,1.17931}, // 60 < jet pT < 70 GeV
   {1.35642,1.27865,1.16101,1.07808,1.03014,1.01009,1.01418,1.03222}, // 70 < jet pT < 80 GeV
   {1.31772,1.23843,1.11785,1.02908,0.975607,0.945008,0.927762,0.92732}, // 80 < jet pT < 90 GeV
   {1.28357,1.20542,1.08786,1.00208,0.947962,0.909092,0.885459,0.873589}, // 90 < jet pT < 100 GeV
   {1.25439,1.1782,1.06449,0.980728,0.925323,0.878733,0.850852,0.832934}, // 100 < jet pT < 110 GeV
   {1.23287,1.16058,1.04762,0.964998,0.90549,0.857908,0.829481,0.807518}, // 110 < jet pT < 120 GeV
   {1.20602,1.13465,1.03053,0.951582,0.894932,0.85086,0.820355,0.798587}, // 120 < jet pT < 140 GeV
   {1.17994,1.11509,1.02249,0.953231,0.907155,0.872099,0.845826,0.836501}, // 140 < jet pT < 160 GeV
   {1.15993,1.101,1.01848,0.959038,0.916504,0.881203,0.864311,0.848766}, // 160 < jet pT < 180 GeV
   {1.14232,1.0885,1.01317,0.95741,0.918475,0.889429,0.868711,0.85658}, // 180 < jet pT < 200 GeV
   {1.13197,1.08393,1.01764,0.973473,0.947287,0.930409,0.927996,0.92468}, // 200 < jet pT < 220 GeV
   {1.12197,1.0776,1.01706,0.978097,0.959847,0.955303,0.961111,0.993752}, // 220 < jet pT < 240 GeV
   {1.11304,1.07143,1.01655,0.98573,0.975402,0.967289,0.987284,1.02075}, // 240 < jet pT < 260 GeV
   {1.10703,1.06788,1.01774,0.986007,0.974744,0.975559,0.989997,1.02782}, // 260 < jet pT < 280 GeV
   {1.09869,1.06089,1.01515,0.984108,0.973707,0.969588,0.996037,1.03932}, // 280 < jet pT < 300 GeV
   {1.08748,1.05697,1.01946,1.00176,1.0035,1.02786,1.07663,1.14076}, // 300 < jet pT < 500 GeV
   {1.06178,1.04461,1.03088,1.03486,1.05944,1.10846,1.19897,1.32231}, // 500 < jet pT < 5020 GeV
   {1.31863,1.24129,1.12451,1.04123,0.991244,0.962887,0.952942,0.956806}, // 60 GeV < jet pT
   {1.10881,1.06702,1.01089,0.974611,0.956623,0.947139,0.954082,0.972533}, // 200 < jet pT < 300 GeV
   {1.16515,1.10337,1.01569,0.95081,0.906026,0.871724,0.850157,0.838499}}, // 120 GeV < jet pT
   // Centrality 10-30%
  {{1.27835,1.2153,1.13135,1.082,1.0699,1.08619,1.12645,1.1818}, // 60 < jet pT < 70 GeV
   {1.23324,1.16835,1.07736,1.01772,0.98722,0.978573,0.987761,1.00909}, // 70 < jet pT < 80 GeV
   {1.19765,1.13344,1.03887,0.973323,0.933304,0.912293,0.905537,0.910225}, // 80 < jet pT < 90 GeV
   {1.16968,1.10548,1.01371,0.947881,0.899393,0.865494,0.849882,0.850625}, // 90 < jet pT < 100 GeV
   {1.14908,1.08784,1.00283,0.936972,0.897243,0.864217,0.837092,0.824712}, // 100 < jet pT < 110 GeV
   {1.133,1.07484,0.99181,0.927048,0.881303,0.850816,0.827682,0.807845}, // 110 < jet pT < 120 GeV
   {1.1181,1.06495,0.988863,0.932039,0.890785,0.857578,0.832805,0.828497}, // 120 < jet pT < 140 GeV
   {1.10393,1.0558,0.990223,0.943023,0.908237,0.879383,0.869357,0.863023}, // 140 < jet pT < 160 GeV
   {1.09561,1.05388,0.997654,0.960358,0.936797,0.922042,0.920323,0.930456}, // 160 < jet pT < 180 GeV
   {1.08653,1.04831,0.998404,0.968269,0.954748,0.948386,0.95859,0.984393}, // 180 < jet pT < 200 GeV
   {1.08412,1.05065,1.01069,0.990582,0.981933,0.996771,1.03604,1.07133}, // 200 < jet pT < 220 GeV
   {1.07799,1.04768,1.01109,0.991818,0.99197,1.01111,1.04875,1.10821}, // 220 < jet pT < 240 GeV
   {1.07391,1.04662,1.01592,1.00377,1.01053,1.04102,1.08775,1.14963}, // 240 < jet pT < 260 GeV
   {1.06991,1.04334,1.01352,1.00146,1.00698,1.03198,1.07047,1.1213}, // 260 < jet pT < 280 GeV
   {1.07028,1.04905,1.02703,1.0249,1.04742,1.09501,1.16822,1.2578}, // 280 < jet pT < 300 GeV
   {1.06366,1.04597,1.03058,1.03729,1.07201,1.13227,1.22344,1.34008}, // 300 < jet pT < 500 GeV
   {1.05174,1.04379,1.04752,1.07491,1.13574,1.2406,1.40061,1.59647}, // 500 < jet pT < 5020 GeV
   {1.20989,1.14708,1.05938,1.00015,0.96746,0.952816,0.953488,0.965812}, // 60 GeV < jet pT
   {1.06958,1.04145,1.00864,0.993383,0.993525,1.01506,1.0569,1.10702}, // 200 < jet pT < 300 GeV
   {1.09349,1.04909,0.987998,0.944806,0.915401,0.894741,0.886761,0.893141}}, // 120 GeV < jet pT
   // Centrality 30-50%
  {{1.15134,1.11558,1.07919,1.07728,1.11252,1.17766,1.27808,1.39886}, // 60 < jet pT < 70 GeV
   {1.10531,1.06626,1.01781,0.996646,0.996264,1.01803,1.06944,1.13493}, // 70 < jet pT < 80 GeV
   {1.08107,1.04323,0.991731,0.962536,0.947407,0.950357,0.973088,1.00171}, // 80 < jet pT < 90 GeV
   {1.06424,1.02563,0.972614,0.937403,0.921653,0.918889,0.918388,0.936001}, // 90 < jet pT < 100 GeV
   {1.0561,1.02018,0.973948,0.942598,0.925156,0.921355,0.940857,0.977592}, // 100 < jet pT < 110 GeV
   {1.05259,1.02064,0.976748,0.949038,0.938371,0.943403,0.963727,0.995001}, // 110 < jet pT < 120 GeV
   {1.05058,1.02098,0.98349,0.961493,0.953467,0.959778,0.979675,1.01552}, // 120 < jet pT < 140 GeV
   {1.05348,1.03027,1.00656,0.995338,1.00722,1.03021,1.07484,1.16617}, // 140 < jet pT < 160 GeV
   {1.05524,1.03621,1.01728,1.01681,1.03469,1.07341,1.1283,1.1772}, // 160 < jet pT < 180 GeV
   {1.05595,1.04075,1.03113,1.03967,1.08085,1.13687,1.22962,1.33283}, // 180 < jet pT < 200 GeV
   {1.06479,1.0545,1.05775,1.08504,1.14229,1.24457,1.37672,1.5324}, // 200 < jet pT < 220 GeV
   {1.06229,1.05274,1.0566,1.09028,1.15713,1.2589,1.38709,1.5468}, // 220 < jet pT < 240 GeV
   {1.06308,1.05731,1.0658,1.11164,1.19481,1.32407,1.47483,1.69594}, // 240 < jet pT < 260 GeV
   {1.06471,1.06049,1.06856,1.11276,1.19173,1.33034,1.51113,1.72596}, // 260 < jet pT < 280 GeV
   {1.0662,1.06531,1.0841,1.14137,1.25624,1.42633,1.65717,1.93388}, // 280 < jet pT < 300 GeV
   {1.0741,1.07803,1.10965,1.18457,1.32182,1.52567,1.79058,2.10336}, // 300 < jet pT < 500 GeV
   {1.0847,1.09802,1.15441,1.26664,1.47394,1.77887,2.19516,2.65188}, // 500 < jet pT < 5020 GeV
   {1.10088,1.06475,1.02097,1.00202,1.00558,1.02873,1.07358,1.13262}, // 60 GeV < jet pT
   {1.05942,1.05222,1.05893,1.09465,1.16399,1.27751,1.42002,1.59819}, // 200 < jet pT < 300 GeV
   {1.04791,1.02621,1.00343,0.996898,1.01039,1.04142,1.09119,1.16301}}, // 120 GeV < jet pT
   // Centrality 50-90%
  {{1.17713,1.18053,1.22995,1.33769,1.51567,1.76498,2.13387,2.59061}, // 60 < jet pT < 70 GeV
   {1.1408,1.13641,1.16106,1.24259,1.3658,1.54251,1.77676,2.06929}, // 70 < jet pT < 80 GeV
   {1.12262,1.11612,1.13466,1.19295,1.30129,1.45365,1.64877,1.85582}, // 80 < jet pT < 90 GeV
   {1.11736,1.11213,1.132,1.19304,1.2973,1.43844,1.63387,1.83964}, // 90 < jet pT < 100 GeV
   {1.12286,1.11872,1.14732,1.21523,1.33743,1.5134,1.67082,1.86788}, // 100 < jet pT < 110 GeV
   {1.13069,1.13357,1.17006,1.2608,1.40093,1.56932,1.76113,1.98052}, // 110 < jet pT < 120 GeV
   {1.13938,1.14703,1.19253,1.29492,1.44109,1.65854,1.88541,2.14144}, // 120 < jet pT < 140 GeV
   {1.15876,1.17276,1.23901,1.36839,1.57998,1.8632,2.15946,2.45395}, // 140 < jet pT < 160 GeV
   {1.17428,1.19737,1.28219,1.45559,1.73759,2.11363,2.56425,2.95137}, // 160 < jet pT < 180 GeV
   {1.18383,1.21066,1.31402,1.4805,1.75656,2.12419,2.49648,2.85306}, // 180 < jet pT < 200 GeV
   {1.20237,1.23806,1.36368,1.5998,1.97996,2.49935,3.12101,3.86156}, // 200 < jet pT < 220 GeV
   {1.21235,1.25408,1.393,1.65535,2.05224,2.58806,3.301,3.99866}, // 220 < jet pT < 240 GeV
   {1.21416,1.25431,1.393,1.64616,2.03427,2.51036,3.0995,3.73129}, // 240 < jet pT < 260 GeV
   {1.24483,1.29904,1.47083,1.81265,2.35156,3.16484,4.2591,5.29721}, // 260 < jet pT < 280 GeV
   {1.23772,1.28349,1.45424,1.77095,2.28124,3.07379,4.02943,4.98414}, // 280 < jet pT < 300 GeV
   {1.26566,1.32965,1.53022,1.90496,2.5248,3.44323,4.54679,5.87069}, // 300 < jet pT < 500 GeV
   {1.3202,1.40733,1.69838,2.22605,3.09695,4.4036,6.00362,8.01026}, // 500 < jet pT < 5020 GeV
   {1.14785,1.14789,1.18411,1.27345,1.41899,1.62162,1.8826,2.18167}, // 60 GeV < jet pT
   {1.21108,1.25163,1.38978,1.65001,2.05774,2.61467,3.31257,4.05708}, // 200 < jet pT < 300 GeV
   {1.15858,1.1757,1.24724,1.38973,1.60978,1.91682,2.2532,2.60344}} // 120 GeV < jet pT
  },
  // The second part of the array gives the same numbers for a generator level jet study
  // All but last two rows from file: PbPbMC2018_GenGen_eecAnalysis_akFlowJets_miniAOD_4pCentShift_noTrigger_cutBadPhi_moreLowPtBins_truthReferenceForUnfolding_processed_2023-05-20.root
  // Last two rows from file: PbPbMC2018_GenGen_eecAnalysis_akFlowJets_miniAOD_4pCentShift_noTrigger_finalMcWeight_fixCentrality_processed_2023-03-08.root
  {
   // Centrality 0-10%
  {{1.38632,1.31176,1.19974,1.12733,1.08949,1.07698,1.08529,1.10874}, // 60 < jet pT < 70 GeV
   {1.34945,1.27827,1.17336,1.10679,1.07283,1.06014,1.07207,1.08778}, // 70 < jet pT < 80 GeV
   {1.32211,1.2548,1.15912,1.09759,1.07252,1.06606,1.07945,1.09609}, // 80 < jet pT < 90 GeV
   {1.29802,1.23408,1.14671,1.09444,1.07891,1.07641,1.09454,1.13376}, // 90 < jet pT < 100 GeV
   {1.27754,1.21699,1.13411,1.08709,1.07195,1.07664,1.09635,1.13436}, // 100 < jet pT < 110 GeV
   {1.25577,1.19795,1.12077,1.07623,1.06055,1.0649,1.08217,1.10877}, // 110 < jet pT < 120 GeV
   {1.23902,1.18572,1.11883,1.08248,1.07472,1.0927,1.12392,1.17018}, // 120 < jet pT < 140 GeV
   {1.21563,1.16776,1.10839,1.08069,1.08403,1.1047,1.15116,1.2221}, // 140 < jet pT < 160 GeV
   {1.1959,1.15201,1.10044,1.0766,1.08078,1.1065,1.16148,1.22497}, // 160 < jet pT < 180 GeV
   {1.17867,1.13894,1.09219,1.07495,1.08327,1.1142,1.16193,1.23011}, // 180 < jet pT < 200 GeV
   {1.16629,1.13086,1.09037,1.07657,1.09122,1.12229,1.17036,1.24263}, // 200 < jet pT < 220 GeV
   {1.1549,1.12156,1.08488,1.07812,1.09914,1.13906,1.19859,1.28865}, // 220 < jet pT < 240 GeV
   {1.1453,1.11349,1.08006,1.07483,1.09515,1.14174,1.21901,1.33506}, // 240 < jet pT < 260 GeV
   {1.13671,1.10782,1.07747,1.07168,1.09587,1.14033,1.22939,1.3424}, // 260 < jet pT < 280 GeV
   {1.13099,1.10385,1.07799,1.0773,1.10162,1.15371,1.23885,1.35287}, // 280 < jet pT < 300 GeV
   {1.11305,1.09084,1.07091,1.07554,1.10865,1.17429,1.27523,1.40506}, // 300 < jet pT < 500 GeV
   {1.08236,1.07061,1.06867,1.08913,1.138,1.21488,1.3498,1.53014}, // 500 < jet pT < 5020 GeV
   {1.33584,1.26682,1.16776,1.10642,1.07933,1.07409,1.08987,1.11761}, // 60 GeV < jet pT
   {1.14204,1.11183,1.07952,1.07312,1.09286,1.12971,1.1915,1.27956}, // 200 < jet pT < 300 GeV
   {1.19709,1.15238,1.0986,1.07378,1.07577,1.09889,1.14123,1.20407}}, // 120 GeV < jet pT
  // Centrality 10-30%
  {{1.28655,1.22645,1.14635,1.0998,1.0816,1.08798,1.11018,1.13755}, // 60 < jet pT < 70 GeV
   {1.25884,1.2043,1.13254,1.0952,1.08691,1.09753,1.12702,1.16256}, // 70 < jet pT < 80 GeV
   {1.23471,1.18452,1.11984,1.08723,1.08727,1.10668,1.13481,1.17444}, // 80 < jet pT < 90 GeV
   {1.21756,1.17054,1.11331,1.08593,1.08016,1.10028,1.12619,1.1749}, // 90 < jet pT < 100 GeV
   {1.19959,1.15649,1.10554,1.08434,1.08841,1.10794,1.14446,1.20081}, // 100 < jet pT < 110 GeV
   {1.18567,1.14559,1.09813,1.07843,1.08799,1.12114,1.16888,1.23529}, // 110 < jet pT < 120 GeV
   {1.17321,1.1368,1.0968,1.08599,1.10024,1.13636,1.197,1.27227}, // 120 < jet pT < 140 GeV
   {1.15641,1.12533,1.0928,1.0892,1.11245,1.15647,1.23254,1.32013}, // 140 < jet pT < 160 GeV
   {1.1425,1.11495,1.08808,1.09018,1.11576,1.16525,1.2439,1.34708}, // 160 < jet pT < 180 GeV
   {1.13441,1.1108,1.08891,1.09579,1.1277,1.18863,1.28801,1.41329}, // 180 < jet pT < 200 GeV
   {1.12285,1.10073,1.08345,1.09428,1.1321,1.20086,1.30668,1.43032}, // 200 < jet pT < 220 GeV
   {1.11819,1.09855,1.08639,1.1011,1.14556,1.22916,1.34348,1.50499}, // 220 < jet pT < 240 GeV
   {1.11289,1.095,1.08681,1.10559,1.15685,1.24329,1.36041,1.50304}, // 240 < jet pT < 260 GeV
   {1.10728,1.09239,1.08656,1.10199,1.1542,1.24499,1.37962,1.54298}, // 260 < jet pT < 280 GeV
   {1.10102,1.08775,1.08363,1.10759,1.16454,1.26182,1.40848,1.59629}, // 280 < jet pT < 300 GeV
   {1.0927,1.08312,1.08471,1.11618,1.18522,1.29604,1.45237,1.66051}, // 300 < jet pT < 500 GeV
   {1.07596,1.07423,1.09108,1.13606,1.22184,1.36942,1.59333,1.86902}, // 500 < jet pT < 5020 GeV
   {1.24657,1.19409,1.12707,1.09299,1.08744,1.10427,1.13735,1.18154}, // 60 GeV < jet pT
   {1.10868,1.09138,1.08198,1.0981,1.14311,1.22177,1.33707,1.47936}, // 200 < jet pT < 300 GeV
   {1.14364,1.11512,1.08685,1.08577,1.10946,1.15741,1.23448,1.33111}}, // 120 GeV < jet pT
   // Centrality 30-50%
  {{1.17765,1.14814,1.11966,1.12211,1.15436,1.21149,1.29438,1.37825}, // 60 < jet pT < 70 GeV
   {1.16244,1.13649,1.11563,1.12713,1.1641,1.22336,1.3139,1.41572}, // 70 < jet pT < 80 GeV
   {1.15072,1.12834,1.11428,1.12993,1.16685,1.23223,1.3159,1.42168}, // 80 < jet pT < 90 GeV
   {1.14244,1.12377,1.11329,1.13278,1.17945,1.24958,1.34569,1.44076}, // 90 < jet pT < 100 GeV
   {1.13568,1.1198,1.11464,1.14004,1.19908,1.28572,1.40552,1.5607}, // 100 < jet pT < 110 GeV
   {1.12901,1.11542,1.11681,1.14358,1.21141,1.31483,1.45401,1.64396}, // 110 < jet pT < 120 GeV
   {1.12506,1.11466,1.12082,1.15849,1.23363,1.33569,1.46617,1.65172}, // 120 < jet pT < 140 GeV
   {1.11807,1.11154,1.12404,1.16919,1.25378,1.39288,1.57655,1.81604}, // 140 < jet pT < 160 GeV
   {1.11717,1.11474,1.13592,1.18671,1.28907,1.44308,1.64878,1.89172}, // 160 < jet pT < 180 GeV
   {1.11125,1.11088,1.13504,1.19714,1.31016,1.48738,1.72639,2.01935}, // 180 < jet pT < 200 GeV
   {1.11118,1.11226,1.14211,1.21572,1.33922,1.53104,1.80117,2.12328}, // 200 < jet pT < 220 GeV
   {1.109,1.11295,1.14311,1.21726,1.35376,1.54286,1.82591,2.18296}, // 220 < jet pT < 240 GeV
   {1.1066,1.11183,1.14934,1.23227,1.37361,1.59756,1.88549,2.27511}, // 240 < jet pT < 260 GeV
   {1.10424,1.11061,1.14634,1.23192,1.37793,1.61325,1.89952,2.28649}, // 260 < jet pT < 280 GeV
   {1.10969,1.11975,1.16881,1.26102,1.42611,1.68935,2.03155,2.46165}, // 280 < jet pT < 300 GeV
   {1.10965,1.12316,1.17639,1.28909,1.48248,1.7776,2.17915,2.66338}, // 300 < jet pT < 500 GeV
   {1.11354,1.1356,1.21514,1.36047,1.62087,2.02412,2.58572,3.25207}, // 500 < jet pT < 5020 GeV
   {1.15738,1.13423,1.11789,1.13291,1.1777,1.25023,1.35199,1.46979}, // 60 GeV < jet pT
   {1.10473,1.10922,1.14383,1.22247,1.35651,1.56217,1.84996,2.21101}, // 200 < jet pT < 300 GeV
   {1.11356,1.10885,1.12503,1.17484,1.26895,1.40669,1.59,1.82841}}, // 120 GeV < jet pT
   // Centrality 50-90%
  {{1.21944,1.23164,1.29256,1.41725,1.62002,1.87873,2.18221,2.57361}, // 60 < jet pT < 70 GeV
   {1.21407,1.22648,1.28958,1.42374,1.61992,1.89855,2.22607,2.59089}, // 70 < jet pT < 80 GeV
   {1.21274,1.22976,1.30287,1.44571,1.6663,1.97596,2.37649,2.77648}, // 80 < jet pT < 90 GeV
   {1.21738,1.2382,1.32278,1.47824,1.75435,2.12838,2.51666,2.91635}, // 90 < jet pT < 100 GeV
   {1.21902,1.24171,1.33283,1.51023,1.76633,2.13836,2.59744,3.15097}, // 100 < jet pT < 110 GeV
   {1.22841,1.25873,1.36303,1.55293,1.87618,2.3358,2.92476,3.59651}, // 110 < jet pT < 120 GeV
   {1.22915,1.26038,1.37046,1.5733,1.91025,2.41459,3.04212,3.77907}, // 120 < jet pT < 140 GeV
   {1.23666,1.27262,1.40099,1.64212,2.0416,2.59387,3.26911,4.07981}, // 140 < jet pT < 160 GeV
   {1.24773,1.29346,1.43459,1.69488,2.13996,2.81735,3.75066,4.76215}, // 160 < jet pT < 180 GeV
   {1.25506,1.30211,1.46002,1.75381,2.23157,2.88952,3.66253,4.53526}, // 180 < jet pT < 200 GeV
   {1.25409,1.30632,1.47174,1.78836,2.27256,2.98562,3.98609,5.10848}, // 200 < jet pT < 220 GeV
   {1.27015,1.32771,1.50801,1.84755,2.39034,3.18186,4.23529,5.53934}, // 220 < jet pT < 240 GeV
   {1.28668,1.35177,1.55965,1.95601,2.61671,3.62153,4.97261,6.59301}, // 240 < jet pT < 260 GeV
   {1.28346,1.34384,1.54878,1.93656,2.56677,3.52397,4.72041,6.02032}, // 260 < jet pT < 280 GeV
   {1.29112,1.36128,1.57741,1.9781,2.65157,3.65699,4.9165,6.58861}, // 280 < jet pT < 300 GeV
   {1.31249,1.39034,1.63676,2.09984,2.87619,4.09824,5.64267,7.55251}, // 300 < jet pT < 500 GeV
   {1.36059,1.46433,1.79656,2.40811,3.43729,5.00804,7.03842,9.53993}, // 500 < jet pT < 5020 GeV
   {1.2196,1.23741,1.31372,1.46476,1.7057,2.0389,2.44091,2.90668}, // 60 GeV < jet pT
   {1.26656,1.32405,1.50711,1.85368,2.42182,3.26258,4.38555,5.71303}, // 200 < jet pT < 300 GeV
   {1.23819,1.27774,1.41011,1.65563,2.06399,2.66084,3.4269,4.30642}} // 120 GeV < jet pT
  }},

  // The second pair of arrays gives the parameters determined from 2% centrality shifted simulation
  // This is used for systematic uncertainty evaluation

  {
  // The first part of the array gives the results for reconstructed jets.
  // The file that was used to produce all the numbers in each centrality bin is PbPbMC2018_RecoGen_eecAnalysis_akFlowJets_miniAOD_2pCentShift_noTrigger_cutBadPhi_noJetPtWeight_forBackgroundScale_processed_2023-06-06.root
  // The macro for the study is findBackgroundNormalizationScale.C
  // Git hash: 6b4036e395002c31c4d50d9261a90c4310a26e60
  // TODO: Jets are not matched here! The numbers will thus not be good!
  {

  // Centrality 0-10%
  {{1.51017,1.42658,1.27956,1.14991,1.05242,0.983294,0.93506,0.898297}, // 60 < jet pT < 70 GeV
   {1.45253,1.3658,1.21784,1.09188,0.994775,0.921223,0.869996,0.818768}, // 70 < jet pT < 80 GeV
   {1.40642,1.31687,1.16725,1.03877,0.945132,0.866922,0.805203,0.755079}, // 80 < jet pT < 90 GeV
   {1.36772,1.27832,1.13058,1.00505,0.910323,0.828926,0.758336,0.705346}, // 90 < jet pT < 100 GeV
   {1.33564,1.24733,1.10073,0.978167,0.880633,0.792838,0.722505,0.658328}, // 100 < jet pT < 110 GeV
   {1.30758,1.21966,1.07366,0.950842,0.850511,0.761068,0.689247,0.624623}, // 110 < jet pT < 120 GeV
   {1.27711,1.19062,1.05336,0.937589,0.84055,0.750557,0.678112,0.605362}, // 120 < jet pT < 140 GeV
   {1.24238,1.15919,1.02795,0.912893,0.817228,0.720061,0.640044,0.569327}, // 140 < jet pT < 160 GeV
   {1.21014,1.13004,1.00344,0.888945,0.778712,0.678099,0.577747,0.483905}, // 160 < jet pT < 180 GeV
   {1.17947,1.10272,0.97817,0.857283,0.743005,0.634456,0.525339,0.429344}, // 180 < jet pT < 200 GeV
   {1.188,1.12448,1.02992,0.957608,0.901287,0.85147,0.8092,0.753017}, // 200 < jet pT < 220 GeV
   {1.17416,1.11563,1.02685,0.95748,0.904269,0.859209,0.813983,0.786068}, // 220 < jet pT < 240 GeV
   {1.16661,1.11178,1.03661,0.986321,0.959021,0.936197,0.93199,0.929516}, // 240 < jet pT < 260 GeV
   {1.15909,1.108,1.0397,0.9958,0.972964,0.969197,0.975741,0.996047}, // 260 < jet pT < 280 GeV
   {1.14593,1.09673,1.03159,0.986174,0.962787,0.947452,0.947166,0.961143}, // 280 < jet pT < 300 GeV
   {1.13187,1.09079,1.03871,1.01097,1.00608,1.0237,1.06343,1.12005}, // 300 < jet pT < 500 GeV
   {1.09093,1.06605,1.04173,1.03817,1.05782,1.1018,1.18909,1.30267}, // 500 < jet pT < 5020 GeV
   {1.42044,1.33177,1.18132,1.05172,0.951461,0.868747,0.80265,0.743393}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
   // Centrality 10-30%
  {{1.35506,1.27662,1.15605,1.06224,0.998203,0.953454,0.922741,0.894849}, // 60 < jet pT < 70 GeV
   {1.3072,1.22766,1.1064,1.01039,0.941745,0.889717,0.846621,0.814998}, // 70 < jet pT < 80 GeV
   {1.26906,1.19074,1.06693,0.970534,0.895798,0.836204,0.782952,0.743992}, // 80 < jet pT < 90 GeV
   {1.23661,1.15764,1.03756,0.940838,0.86313,0.794037,0.738754,0.693791}, // 90 < jet pT < 100 GeV
   {1.21161,1.13532,1.0199,0.925286,0.851336,0.782915,0.716303,0.658642}, // 100 < jet pT < 110 GeV
   {1.19221,1.11898,1.00551,0.909012,0.829657,0.759955,0.695462,0.631158}, // 110 < jet pT < 120 GeV
   {1.17181,1.10281,0.996648,0.907605,0.830399,0.755172,0.688939,0.636524}, // 120 < jet pT < 140 GeV
   {1.15052,1.08593,0.990371,0.911613,0.840406,0.764216,0.69704,0.631803}, // 140 < jet pT < 160 GeV
   {1.1359,1.07793,0.991445,0.920692,0.855935,0.791643,0.734245,0.679453}, // 160 < jet pT < 180 GeV
   {1.12207,1.06822,0.988913,0.920445,0.858807,0.791937,0.72219,0.671246}, // 180 < jet pT < 200 GeV
   {1.11861,1.07167,1.00612,0.955302,0.905916,0.85851,0.815847,0.774999}, // 200 < jet pT < 220 GeV
   {1.11603,1.07499,1.0198,0.985093,0.966406,0.959343,0.959555,0.983111}, // 220 < jet pT < 240 GeV
   {1.11017,1.07322,1.02898,1.00761,1.00891,1.02747,1.06464,1.11582}, // 240 < jet pT < 260 GeV
   {1.10312,1.06717,1.0237,0.99966,0.994053,1.00321,1.02425,1.06205}, // 260 < jet pT < 280 GeV
   {1.10195,1.07065,1.03482,1.02159,1.03201,1.06681,1.13353,1.21332}, // 280 < jet pT < 300 GeV
   {1.02962,0.981223,0.901871,0.7991,0.67589,0.557711,0.468225,0.403885}, // 300 < jet pT < 500 GeV
   {1.06781,1.05417,1.04905,1.06889,1.11909,1.21099,1.34851,1.51759}, // 500 < jet pT < 5020 GeV
   {1.28208,1.20378,1.08362,0.988043,0.915632,0.855519,0.803986,0.76003}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
   // Centrality 30-50%
  {{1.19032,1.13899,1.0726,1.03444,1.0224,1.02041,1.02922,1.04007}, // 60 < jet pT < 70 GeV
   {1.14345,1.09106,1.0177,0.967996,0.934654,0.914527,0.903708,0.900452}, // 70 < jet pT < 80 GeV
   {1.1159,1.06422,0.989552,0.933473,0.886654,0.856974,0.830044,0.806051}, // 80 < jet pT < 90 GeV
   {1.09646,1.0454,0.970268,0.911496,0.865137,0.822892,0.785426,0.765705}, // 90 < jet pT < 100 GeV
   {1.0825,1.03344,0.962345,0.902626,0.855112,0.804894,0.772812,0.752858}, // 100 < jet pT < 110 GeV
   {1.07316,1.02701,0.956399,0.898374,0.847538,0.802468,0.757189,0.722522}, // 110 < jet pT < 120 GeV
   {1.05815,1.01318,0.942929,0.877282,0.812563,0.75047,0.701321,0.658055}, // 120 < jet pT < 140 GeV
   {1.06453,1.02796,0.976415,0.927786,0.885307,0.836807,0.805044,0.803683}, // 140 < jet pT < 160 GeV
   {1.06606,1.03531,0.992784,0.960814,0.933461,0.916386,0.894022,0.878751}, // 160 < jet pT < 180 GeV
   {1.01539,0.974263,0.893859,0.794107,0.713338,0.598567,0.506678,0.451038}, // 180 < jet pT < 200 GeV
   {1.05185,1.02157,0.976963,0.927997,0.862309,0.793751,0.721653,0.665778}, // 200 < jet pT < 220 GeV
   {1.05829,1.03325,1.00558,0.978249,0.950653,0.913532,0.864223,0.811385}, // 220 < jet pT < 240 GeV
   {1.02892,0.993376,0.932612,0.865774,0.787953,0.699766,0.617349,0.555149}, // 240 < jet pT < 260 GeV
   {1.02679,0.996022,0.929262,0.85574,0.798689,0.70943,0.655822,0.589998}, // 260 < jet pT < 280 GeV
   {0.965133,0.917693,0.817234,0.668428,0.602972,0.451066,0.363901,0.355476}, // 280 < jet pT < 300 GeV
   {1.06893,1.06188,1.06486,1.09265,1.16304,1.23438,1.29199,1.40028}, // 300 < jet pT < 500 GeV
   {1.08581,1.09581,1.14253,1.24069,1.42904,1.70987,2.09304,2.53167}, // 500 < jet pT < 5020 GeV
   {1.1336,1.08286,1.01152,0.959468,0.921621,0.889738,0.863842,0.845072}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
   // Centrality 50-90%
  {{1.16951,1.16085,1.17979,1.23714,1.32832,1.45726,1.6206,1.82464}, // 60 < jet pT < 70 GeV
   {1.13466,1.11873,1.11598,1.1536,1.21571,1.30252,1.40119,1.50741}, // 70 < jet pT < 80 GeV
   {1.11121,1.09282,1.08107,1.09246,1.12847,1.18747,1.24586,1.28989}, // 80 < jet pT < 90 GeV
   {1.10599,1.08991,1.08435,1.09962,1.14361,1.19987,1.26957,1.33312}, // 90 < jet pT < 100 GeV
   {1.10508,1.08833,1.08833,1.10901,1.1436,1.18768,1.208,1.23515}, // 100 < jet pT < 110 GeV
   {1.11679,1.10925,1.12457,1.17218,1.25439,1.35533,1.46042,1.59614}, // 110 < jet pT < 120 GeV
   {1.11169,1.1033,1.10883,1.14184,1.18079,1.22797,1.28282,1.31135}, // 120 < jet pT < 140 GeV
   {1.11221,1.10864,1.11647,1.1396,1.17984,1.19782,1.21604,1.19139}, // 140 < jet pT < 160 GeV
   {1.1547,1.16816,1.22436,1.35006,1.54608,1.8007,2.08119,2.29249}, // 160 < jet pT < 180 GeV
   {1.14165,1.14841,1.19444,1.25232,1.33312,1.40596,1.465,1.46808}, // 180 < jet pT < 200 GeV
   {1.16869,1.1887,1.27174,1.42547,1.64369,1.88762,2.17645,2.3937}, // 200 < jet pT < 220 GeV
   {1.18509,1.21383,1.31595,1.51379,1.79832,2.15953,2.61779,2.99669}, // 220 < jet pT < 240 GeV
   {1.19484,1.22691,1.34476,1.56519,1.90273,2.35189,2.8748,3.41704}, // 240 < jet pT < 260 GeV
   {1.21753,1.25973,1.40047,1.67436,2.11821,2.75618,3.57164,4.33281}, // 260 < jet pT < 280 GeV
   {1.21083,1.2473,1.38908,1.65014,2.08703,2.72779,3.4621,4.19938}, // 280 < jet pT < 300 GeV
   {1.23895,1.29213,1.46528,1.79291,2.33588,3.133,4.11701,5.37005}, // 300 < jet pT < 500 GeV
   {1.28727,1.36476,1.61504,2.07568,2.84011,3.96341,5.32659,6.92763}, // 500 < jet pT < 5020 GeV
   {1.13633,1.12413,1.13003,1.16854,1.23368,1.32105,1.41736,1.51244}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}} // 120 GeV < jet pT
  },
  // The second part of the array gives the same numbers for a generator level jet study
  // The file used for the numbers: PbPbMC2018_GenGen_eecAnalysis_akFlowJets_miniAOD_2pCentShift_noTrigger_cutBadPhi_noJetPtWeight_forBackgroundScale_processed_2023-06-06.root
  // Git hash: 6b4036e395002c31c4d50d9261a90c4310a26e60
  {
   // Centrality 0-10%
  {{1.47548,1.39479,1.26342,1.16792,1.11281,1.09107,1.09136,1.11246}, // 60 < jet pT < 70 GeV
   {1.43668,1.35715,1.23124,1.14155,1.08996,1.06315,1.07119,1.0867}, // 70 < jet pT < 80 GeV
   {1.40904,1.33232,1.2129,1.13088,1.09228,1.07799,1.08343,1.10196}, // 80 < jet pT < 90 GeV
   {1.38158,1.30733,1.19606,1.12308,1.09163,1.07785,1.08328,1.11099}, // 90 < jet pT < 100 GeV
   {1.35946,1.28716,1.18324,1.11809,1.09047,1.08918,1.10354,1.13654}, // 100 < jet pT < 110 GeV
   {1.33614,1.26611,1.16693,1.10546,1.07747,1.07297,1.09192,1.11512}, // 110 < jet pT < 120 GeV
   {1.31406,1.24825,1.15815,1.10419,1.08612,1.09351,1.11895,1.15531}, // 120 < jet pT < 140 GeV
   {1.28502,1.22446,1.14348,1.10025,1.09427,1.11046,1.1507,1.21136}, // 140 < jet pT < 160 GeV
   {1.26221,1.20565,1.13264,1.09391,1.08655,1.10336,1.14843,1.21235}, // 160 < jet pT < 180 GeV
   {1.24088,1.18817,1.12196,1.09204,1.09112,1.1182,1.16458,1.22435}, // 180 < jet pT < 200 GeV
   {1.22319,1.17553,1.11568,1.08885,1.0919,1.11584,1.15725,1.21491}, // 200 < jet pT < 220 GeV
   {1.2093,1.16368,1.10869,1.08823,1.10006,1.13315,1.18858,1.2719}, // 220 < jet pT < 240 GeV
   {1.19703,1.15437,1.10407,1.08591,1.09806,1.13923,1.21365,1.31686}, // 240 < jet pT < 260 GeV
   {1.18739,1.14684,1.09904,1.08215,1.09974,1.13927,1.22069,1.32025}, // 260 < jet pT < 280 GeV
   {1.17788,1.13958,1.09833,1.08763,1.10381,1.15129,1.23108,1.32613}, // 280 < jet pT < 300 GeV
   {1.15434,1.12212,1.08801,1.0824,1.10873,1.16878,1.26173,1.387}, // 300 < jet pT < 500 GeV
   {1.10917,1.09015,1.07787,1.09112,1.13233,1.20279,1.33048,1.4958}, // 500 < jet pT < 5020 GeV
   {1.42295,1.345,1.22396,1.14072,1.09782,1.08244,1.09137,1.11604}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
  // Centrality 10-30%
  {{1.36477,1.29398,1.19217,1.12835,1.09817,1.09655,1.1134,1.13539}, // 60 < jet pT < 70 GeV
   {1.33393,1.26776,1.17485,1.12062,1.10125,1.10673,1.12929,1.1573}, // 70 < jet pT < 80 GeV
   {1.30608,1.24329,1.15828,1.10832,1.09757,1.111,1.13459,1.16865}, // 80 < jet pT < 90 GeV
   {1.28486,1.22526,1.14759,1.1034,1.08878,1.0986,1.12089,1.16741}, // 90 < jet pT < 100 GeV
   {1.26433,1.20905,1.13657,1.10015,1.09369,1.10594,1.13633,1.18456}, // 100 < jet pT < 110 GeV
   {1.24711,1.1945,1.12663,1.09202,1.09082,1.11608,1.15816,1.22045}, // 110 < jet pT < 120 GeV
   {1.23081,1.18225,1.1246,1.10034,1.10688,1.13858,1.19591,1.26972}, // 120 < jet pT < 140 GeV
   {1.2085,1.16557,1.11546,1.09877,1.11478,1.15131,1.21948,1.30788}, // 140 < jet pT < 160 GeV
   {1.18963,1.15097,1.10783,1.09842,1.11742,1.16484,1.23572,1.33291}, // 160 < jet pT < 180 GeV
   {1.17882,1.14446,1.10784,1.10485,1.1329,1.18722,1.27851,1.39665}, // 180 < jet pT < 200 GeV
   {1.16518,1.1329,1.10124,1.10151,1.13258,1.19302,1.29137,1.41419}, // 200 < jet pT < 220 GeV
   {1.15487,1.12529,1.09825,1.10206,1.14044,1.21341,1.31835,1.46454}, // 220 < jet pT < 240 GeV
   {1.1475,1.12005,1.09783,1.10801,1.15004,1.22709,1.3395,1.48331}, // 240 < jet pT < 260 GeV
   {1.13907,1.11484,1.09596,1.10429,1.14793,1.23135,1.36194,1.52171}, // 260 < jet pT < 280 GeV
   {1.13231,1.11022,1.09372,1.10613,1.15073,1.23878,1.37571,1.55802}, // 280 < jet pT < 300 GeV
   {1.11916,1.10175,1.0932,1.11642,1.17733,1.27941,1.43004,1.62821}, // 300 < jet pT < 500 GeV
   {1.09198,1.08452,1.09305,1.13239,1.21189,1.35092,1.56558,1.83298}, // 500 < jet pT < 5020 GeV
   {1.31957,1.2551,1.16668,1.11574,1.09928,1.10899,1.13648,1.17521}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
   // Centrality 30-50%
  {{1.22682,1.18569,1.14008,1.1285,1.15008,1.19951,1.27353,1.35114}, // 60 < jet pT < 70 GeV
   {1.20534,1.16815,1.131,1.12779,1.15206,1.20182,1.278,1.36675}, // 70 < jet pT < 80 GeV
   {1.19023,1.15746,1.12621,1.12898,1.15607,1.21287,1.29388,1.39429}, // 80 < jet pT < 90 GeV
   {1.17999,1.15101,1.12622,1.13465,1.17393,1.24033,1.32593,1.41414}, // 90 < jet pT < 100 GeV
   {1.16839,1.14271,1.12322,1.13886,1.18979,1.26439,1.37186,1.51535}, // 100 < jet pT < 110 GeV
   {1.15871,1.13589,1.12299,1.13975,1.20209,1.29989,1.42481,1.59363}, // 110 < jet pT < 120 GeV
   {1.15171,1.13242,1.1243,1.15042,1.21491,1.31053,1.42707,1.60176}, // 120 < jet pT < 140 GeV
   {1.14177,1.12771,1.12594,1.15948,1.2297,1.35257,1.52386,1.73348}, // 140 < jet pT < 160 GeV
   {1.13691,1.12704,1.13585,1.17713,1.26357,1.40467,1.59558,1.82465}, // 160 < jet pT < 180 GeV
   {1.1299,1.12224,1.13338,1.18172,1.27712,1.43278,1.64031,1.88801}, // 180 < jet pT < 200 GeV
   {1.12705,1.12115,1.14137,1.20369,1.31565,1.48338,1.72425,2.02311}, // 200 < jet pT < 220 GeV
   {1.12303,1.12006,1.14006,1.20511,1.32345,1.5065,1.76812,2.10946}, // 220 < jet pT < 240 GeV
   {1.11891,1.11761,1.14427,1.21526,1.34263,1.54508,1.81221,2.16696}, // 240 < jet pT < 260 GeV
   {1.11559,1.11598,1.14034,1.21168,1.34065,1.55589,1.82096,2.15938}, // 260 < jet pT < 280 GeV
   {1.11984,1.12331,1.16023,1.24154,1.39591,1.6369,1.95121,2.34819}, // 280 < jet pT < 300 GeV
   {1.11622,1.12416,1.16696,1.26794,1.44226,1.71389,2.07716,2.53121}, // 300 < jet pT < 500 GeV
   {1.11405,1.1319,1.20052,1.32937,1.5638,1.93131,2.44818,3.07394}, // 500 < jet pT < 5020 GeV
   {1.19901,1.16489,1.13216,1.13391,1.16793,1.2318,1.3228,1.43046}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
   // Centrality 50-90%
  {{1.22024,1.22387,1.26406,1.36658,1.52932,1.74353,2.00317,2.33176}, // 60 < jet pT < 70 GeV
   {1.21698,1.22243,1.27072,1.38668,1.55787,1.80663,2.11035,2.45067}, // 70 < jet pT < 80 GeV
   {1.20966,1.21757,1.27517,1.39362,1.58112,1.84144,2.15952,2.48689}, // 80 < jet pT < 90 GeV
   {1.21052,1.2208,1.28694,1.41019,1.63133,1.91978,2.25278,2.59409}, // 90 < jet pT < 100 GeV
   {1.21191,1.22509,1.29704,1.4425,1.67361,2.01712,2.43369,2.97117}, // 100 < jet pT < 110 GeV
   {1.2167,1.23835,1.32861,1.4871,1.76108,2.14162,2.6327,3.17785}, // 110 < jet pT < 120 GeV
   {1.21654,1.24057,1.33438,1.50721,1.79788,2.21264,2.72273,3.33752}, // 120 < jet pT < 140 GeV
   {1.22498,1.25408,1.36418,1.5771,1.92558,2.41293,3.02843,3.77608}, // 140 < jet pT < 160 GeV
   {1.23366,1.27147,1.38973,1.61678,2.00678,2.56796,3.37416,4.25387}, // 160 < jet pT < 180 GeV
   {1.23389,1.27295,1.40899,1.66227,2.07468,2.6713,3.44777,4.29748}, // 180 < jet pT < 200 GeV
   {1.23777,1.28036,1.42581,1.70397,2.13154,2.77425,3.63044,4.7183}, // 200 < jet pT < 220 GeV
   {1.24907,1.29616,1.45179,1.73962,2.21834,2.91811,3.82914,4.93579}, // 220 < jet pT < 240 GeV
   {1.26377,1.31924,1.50017,1.84778,2.40432,3.28731,4.44616,5.77689}, // 240 < jet pT < 260 GeV
   {1.25873,1.30844,1.48782,1.82195,2.37505,3.19534,4.21975,5.34662}, // 260 < jet pT < 280 GeV
   {1.26781,1.32616,1.51715,1.86869,2.46972,3.38614,4.50343,6.01301}, // 280 < jet pT < 300 GeV
   {1.28284,1.34979,1.5635,1.96956,2.65657,3.70897,5.06643,6.80529}, // 300 < jet pT < 500 GeV
   {1.32567,1.42025,1.71293,2.26403,3.18282,4.58415,6.38794,8.55741}, // 500 < jet pT < 5020 GeV
   {1.21715,1.2264,1.28455,1.41073,1.61348,1.89587,2.24331,2.6485}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}} // 120 GeV < jet pT
  }},

  // The third pair of arrays gives the parameters determined from 6% centrality shifted simulation
  // This is used for systematic uncertainty evaluation

  {
  // The first part of the array gives the results for reconstructed jets.
  // The file that was used to produce all the numbers in each centrality bin is PbPbMC2018_RecoGen_eecAnalysis_akFlowJets_miniAOD_6pCentShift_noTrigger_cutBadPhi_noJetPtWeight_forBackgroundScale_processed_2023-06-06.root
  // The macro for the study is findBackgroundNormalizationScale.C
  // Git hash: 6b4036e395002c31c4d50d9261a90c4310a26e60
  // TODO: Jets are not matched here! The numbers will thus not be good!
  {

  // Centrality 0-10%
  {{1.45774,1.37419,1.23271,1.11507,1.02983,0.970217,0.924214,0.896024}, // 60 < jet pT < 70 GeV
   {1.40438,1.31885,1.17826,1.06208,0.975617,0.907018,0.860471,0.814411}, // 70 < jet pT < 80 GeV
   {1.36066,1.27351,1.13183,1.01569,0.925682,0.856595,0.798667,0.75355}, // 80 < jet pT < 90 GeV
   {1.32422,1.23813,1.09782,0.982493,0.893731,0.810849,0.746915,0.689426}, // 90 < jet pT < 100 GeV
   {1.29147,1.20591,1.068,0.953927,0.861247,0.77683,0.707602,0.637414}, // 100 < jet pT < 110 GeV
   {1.269,1.18637,1.05102,0.937973,0.846508,0.759931,0.68368,0.61398}, // 110 < jet pT < 120 GeV
   {1.23839,1.15601,1.02768,0.917387,0.827666,0.742801,0.671738,0.607505}, // 120 < jet pT < 140 GeV
   {1.20909,1.13189,1.01177,0.910385,0.824177,0.735021,0.657675,0.591158}, // 140 < jet pT < 160 GeV
   {1.18007,1.10743,0.993962,0.892068,0.793649,0.699996,0.611901,0.53131}, // 160 < jet pT < 180 GeV
   {1.15284,1.08398,0.972585,0.859846,0.754901,0.646599,0.530838,0.43995}, // 180 < jet pT < 200 GeV
   {1.16313,1.10635,1.02272,0.958091,0.90622,0.861586,0.819388,0.770323}, // 200 < jet pT < 220 GeV
   {1.14748,1.0939,1.01127,0.938851,0.880971,0.823974,0.766955,0.730157}, // 220 < jet pT < 240 GeV
   {1.14434,1.09511,1.0296,0.987972,0.966325,0.951997,0.960696,0.971739}, // 240 < jet pT < 260 GeV
   {1.13703,1.09093,1.03083,0.994913,0.981548,0.983025,0.994947,1.03191}, // 260 < jet pT < 280 GeV
   {1.13309,1.09054,1.03843,1.00505,0.994461,0.997394,1.03569,1.08533}, // 280 < jet pT < 300 GeV
   {1.11459,1.07871,1.03473,1.01315,1.0149,1.04333,1.09702,1.16865}, // 300 < jet pT < 500 GeV
   {1.08179,1.06092,1.04369,1.04773,1.07684,1.13531,1.24127,1.38135}, // 500 < jet pT < 5020 GeV
   {1.37314,1.28679,1.14481,1.02681,0.936001,0.85998,0.797789,0.742769}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
   // Centrality 10-30%
  {{1.3127,1.23871,1.12948,1.04765,0.993193,0.955499,0.930267,0.906}, // 60 < jet pT < 70 GeV
   {1.26523,1.19067,1.07762,0.989738,0.923812,0.875284,0.832857,0.800124}, // 70 < jet pT < 80 GeV
   {1.22814,1.15394,1.03826,0.948901,0.880374,0.821703,0.771736,0.733474}, // 80 < jet pT < 90 GeV
   {1.1994,1.12659,1.01639,0.927266,0.855633,0.795448,0.743736,0.707511}, // 90 < jet pT < 100 GeV
   {1.1786,1.10801,1.00436,0.919243,0.854406,0.796416,0.737635,0.694192}, // 100 < jet pT < 110 GeV
   {1.1594,1.09105,0.98726,0.898127,0.824667,0.759443,0.701055,0.640142}, // 110 < jet pT < 120 GeV
   {1.14043,1.07669,0.979525,0.897616,0.820442,0.745549,0.67595,0.619283}, // 120 < jet pT < 140 GeV
   {1.12344,1.06432,0.976858,0.903619,0.832109,0.75706,0.695446,0.628465}, // 140 < jet pT < 160 GeV
   {1.11363,1.06125,0.981741,0.912873,0.846042,0.781039,0.727162,0.670767}, // 160 < jet pT < 180 GeV
   {1.08764,1.03384,0.948421,0.863043,0.779154,0.679276,0.588642,0.523308}, // 180 < jet pT < 200 GeV
   {1.0952,1.0498,0.986185,0.929871,0.864781,0.793629,0.728318,0.671233}, // 200 < jet pT < 220 GeV
   {1.09843,1.06113,1.01329,0.981562,0.962567,0.951504,0.942204,0.946465}, // 220 < jet pT < 240 GeV
   {1.09103,1.05504,1.00965,0.977956,0.955188,0.937671,0.911935,0.881102}, // 240 < jet pT < 260 GeV
   {1.0881,1.05502,1.01341,0.990848,0.980898,0.977924,0.982161,0.986413}, // 260 < jet pT < 280 GeV
   {1.06628,1.03111,0.973646,0.913233,0.879523,0.797597,0.716787,0.704191}, // 280 < jet pT < 300 GeV
   {0.994389,0.941287,0.849435,0.726073,0.589323,0.467619,0.383178,0.328116}, // 300 < jet pT < 500 GeV
   {1.06463,1.05415,1.05495,1.08211,1.14431,1.25098,1.40946,1.59877}, // 500 < jet pT < 5020 GeV
   {1.24314,1.16983,1.0594,0.972413,0.905319,0.849005,0.799642,0.757383}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
   // Centrality 30-50%
  {{1.16841,1.12411,1.07026,1.04449,1.04262,1.05484,1.06821,1.09243}, // 60 < jet pT < 70 GeV
   {1.12391,1.07711,1.01463,0.97687,0.956393,0.945392,0.940085,0.943438}, // 70 < jet pT < 80 GeV
   {1.09678,1.05094,0.985422,0.937795,0.899613,0.874235,0.859517,0.844333}, // 80 < jet pT < 90 GeV
   {1.08054,1.0345,0.968237,0.917936,0.880491,0.847866,0.815858,0.793663}, // 90 < jet pT < 100 GeV
   {1.06847,1.02534,0.962035,0.910457,0.861478,0.818268,0.789201,0.766765}, // 100 < jet pT < 110 GeV
   {1.06294,1.02336,0.963097,0.917592,0.879015,0.84717,0.816614,0.798815}, // 110 < jet pT < 120 GeV
   {1.05109,1.01097,0.948657,0.88687,0.825664,0.768647,0.731887,0.689792}, // 120 < jet pT < 140 GeV
   {1.06203,1.03109,0.988583,0.951918,0.919966,0.88628,0.880111,0.888996}, // 140 < jet pT < 160 GeV
   {1.06961,1.04561,1.02001,1.00924,1.01091,1.02337,1.04497,1.04862}, // 160 < jet pT < 180 GeV
   {1.06481,1.04424,1.02205,1.01046,1.01862,1.0219,1.05579,1.0621}, // 180 < jet pT < 200 GeV
   {1.07848,1.06491,1.06249,1.08263,1.13016,1.21086,1.31277,1.40624}, // 200 < jet pT < 220 GeV
   {1.07958,1.06974,1.07263,1.11106,1.18535,1.2915,1.42131,1.58082}, // 220 < jet pT < 240 GeV
   {1.06707,1.05523,1.04685,1.05832,1.08743,1.1206,1.16596,1.20581}, // 240 < jet pT < 260 GeV
   {1.02817,1.00179,0.946466,0.875135,0.811182,0.734461,0.703719,0.63881}, // 260 < jet pT < 280 GeV
   {1.07407,1.06777,1.07887,1.1136,1.19625,1.28689,1.42177,1.52136}, // 280 < jet pT < 300 GeV
   {1.09126,1.09575,1.13118,1.21923,1.37262,1.60058,1.89168,2.23726}, // 300 < jet pT < 500 GeV
   {1.10138,1.11667,1.18344,1.31472,1.55355,1.90718,2.39882,2.96002}, // 500 < jet pT < 5020 GeV
   {1.11703,1.07274,1.01299,0.973354,0.947484,0.929787,0.918101,0.911567}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
   // Centrality 50-90%
  {{1.19875,1.19933,1.24114,1.33688,1.47648,1.66265,1.90496,2.14435}, // 60 < jet pT < 70 GeV
   {1.16552,1.15942,1.17921,1.24665,1.36015,1.49534,1.66463,1.83865}, // 70 < jet pT < 80 GeV
   {1.14741,1.14009,1.15531,1.2052,1.29843,1.39954,1.53031,1.62126}, // 80 < jet pT < 90 GeV
   {1.14578,1.14051,1.16119,1.22422,1.31187,1.43115,1.56753,1.67667}, // 90 < jet pT < 100 GeV
   {1.14679,1.14274,1.16937,1.23996,1.35742,1.51641,1.62564,1.74487}, // 100 < jet pT < 110 GeV
   {1.16584,1.17175,1.22186,1.32747,1.47848,1.65909,1.83358,2.00146}, // 110 < jet pT < 120 GeV
   {1.17261,1.18159,1.23473,1.35119,1.49913,1.70942,1.88502,2.05763}, // 120 < jet pT < 140 GeV
   {1.14377,1.14323,1.15478,1.17798,1.21883,1.20609,1.19433,1.14049}, // 140 < jet pT < 160 GeV
   {1.21182,1.2413,1.34355,1.54416,1.8588,2.25318,2.67349,3.01871}, // 160 < jet pT < 180 GeV
   {1.22492,1.25778,1.37934,1.57679,1.89051,2.28621,2.67696,3.03739}, // 180 < jet pT < 200 GeV
   {1.21474,1.24922,1.35819,1.54734,1.78501,2.00494,2.25795,2.38294}, // 200 < jet pT < 220 GeV
   {1.23954,1.28544,1.42728,1.68116,2.03012,2.42162,2.90118,3.23429}, // 220 < jet pT < 240 GeV
   {1.26252,1.31273,1.48407,1.79647,2.26782,2.87796,3.53783,4.23147}, // 240 < jet pT < 260 GeV
   {1.29773,1.36306,1.57555,1.9951,2.64059,3.63661,4.90466,6.19602}, // 260 < jet pT < 280 GeV
   {1.28161,1.34034,1.54904,1.94687,2.62492,3.59899,4.87705,6.17749}, // 280 < jet pT < 300 GeV
   {1.31937,1.39654,1.64013,2.09443,2.84863,3.95503,5.30008,6.80194}, // 300 < jet pT < 500 GeV
   {1.37665,1.48066,1.82231,2.45712,3.48631,4.96395,6.86132,9.0584}, // 500 < jet pT < 5020 GeV
   {1.17234,1.171,1.20329,1.28399,1.40769,1.55992,1.73344,1.88638}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}} // 120 GeV < jet pT
  },
  // The second part of the array gives the same numbers for a generator level jet study
  // The file used for the numbers: PbPbMC2018_GenGen_eecAnalysis_akFlowJets_miniAOD_6pCentShift_noTrigger_cutBadPhi_noJetPtWeight_forBackgroundScale_processed_2023-06-06.root
  // Git hash: 6b4036e395002c31c4d50d9261a90c4310a26e60
  {
   // Centrality 0-10%
  {{1.43825,1.35978,1.23684,1.15126,1.10426,1.08764,1.09038,1.1102}, // 60 < jet pT < 70 GeV
   {1.40339,1.32773,1.21143,1.13256,1.09057,1.07813,1.09315,1.11304}, // 70 < jet pT < 80 GeV
   {1.37382,1.30123,1.19364,1.12167,1.08922,1.08188,1.09318,1.10984}, // 80 < jet pT < 90 GeV
   {1.34994,1.27979,1.18068,1.11737,1.09565,1.09126,1.1064,1.14369}, // 90 < jet pT < 100 GeV
   {1.32727,1.26042,1.16409,1.10892,1.08509,1.08517,1.11112,1.15049}, // 100 < jet pT < 110 GeV
   {1.30353,1.23884,1.14896,1.09433,1.07225,1.07336,1.09186,1.12642}, // 110 < jet pT < 120 GeV
   {1.28461,1.22387,1.14454,1.1001,1.08889,1.10705,1.14573,1.19947}, // 120 < jet pT < 140 GeV
   {1.25839,1.20336,1.1328,1.09809,1.09776,1.11919,1.1718,1.25152}, // 140 < jet pT < 160 GeV
   {1.23591,1.18491,1.12192,1.09133,1.09212,1.12194,1.17246,1.23777}, // 160 < jet pT < 180 GeV
   {1.21824,1.17125,1.11449,1.09083,1.09764,1.12603,1.18085,1.25607}, // 180 < jet pT < 200 GeV
   {1.20292,1.16028,1.11033,1.0909,1.10351,1.13721,1.19147,1.26911}, // 200 < jet pT < 220 GeV
   {1.19053,1.15112,1.10655,1.09512,1.11721,1.16584,1.23994,1.33324}, // 220 < jet pT < 240 GeV
   {1.17857,1.14012,1.09885,1.09023,1.1142,1.16211,1.24649,1.36508}, // 240 < jet pT < 260 GeV
   {1.16743,1.13292,1.09479,1.08517,1.10529,1.15837,1.2582,1.38964}, // 260 < jet pT < 280 GeV
   {1.16174,1.12854,1.09502,1.08964,1.11426,1.16809,1.25735,1.39104}, // 280 < jet pT < 300 GeV
   {1.13998,1.11258,1.08621,1.08752,1.12147,1.19289,1.30271,1.4412}, // 300 < jet pT < 500 GeV
   {1.10123,1.08533,1.07884,1.09819,1.15158,1.23681,1.39113,1.58285}, // 500 < jet pT < 5020 GeV
   {1.38823,1.31401,1.20295,1.12985,1.09493,1.08769,1.10271,1.13118}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
  // Centrality 10-30%
  {{1.33205,1.26619,1.17543,1.12215,1.09969,1.1051,1.12879,1.15745}, // 60 < jet pT < 70 GeV
   {1.30271,1.24199,1.15923,1.11501,1.10332,1.11405,1.14166,1.17758}, // 70 < jet pT < 80 GeV
   {1.27723,1.22077,1.14483,1.10415,1.09976,1.11805,1.14979,1.19541}, // 80 < jet pT < 90 GeV
   {1.25702,1.20335,1.1349,1.10132,1.08905,1.10825,1.13889,1.19498}, // 90 < jet pT < 100 GeV
   {1.23817,1.18856,1.12746,1.09972,1.10254,1.1248,1.16532,1.22635}, // 100 < jet pT < 110 GeV
   {1.22341,1.17677,1.12015,1.09601,1.10439,1.13784,1.1982,1.26682}, // 110 < jet pT < 120 GeV
   {1.20839,1.16544,1.1165,1.10065,1.1137,1.15066,1.20985,1.28473}, // 120 < jet pT < 140 GeV
   {1.18873,1.15157,1.11075,1.10461,1.12774,1.17472,1.25465,1.34828}, // 140 < jet pT < 160 GeV
   {1.17379,1.14073,1.10825,1.10935,1.13685,1.19161,1.28184,1.39449}, // 160 < jet pT < 180 GeV
   {1.16284,1.13379,1.10473,1.11008,1.14466,1.21646,1.32402,1.46256}, // 180 < jet pT < 200 GeV
   {1.15002,1.12245,1.09872,1.10897,1.14936,1.2234,1.33758,1.46958}, // 200 < jet pT < 220 GeV
   {1.14254,1.11793,1.10047,1.11479,1.16184,1.25,1.37309,1.55549}, // 220 < jet pT < 240 GeV
   {1.1364,1.11407,1.10053,1.117,1.16687,1.26567,1.39425,1.5517}, // 240 < jet pT < 260 GeV
   {1.1304,1.11065,1.09873,1.11469,1.17011,1.26804,1.41426,1.59179}, // 260 < jet pT < 280 GeV
   {1.12229,1.10518,1.09637,1.12256,1.18324,1.28928,1.451,1.65346}, // 280 < jet pT < 300 GeV
   {1.11256,1.09994,1.09935,1.13398,1.20951,1.33065,1.50118,1.73445}, // 300 < jet pT < 500 GeV
   {1.08979,1.08607,1.10249,1.15057,1.24468,1.40913,1.65369,1.96077}, // 500 < jet pT < 5020 GeV
   {1.28965,1.23081,1.15289,1.11212,1.1029,1.11963,1.15486,1.20197}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
   // Centrality 30-50%
  {{1.20756,1.17401,1.14062,1.14204,1.17757,1.24368,1.33473,1.43834}, // 60 < jet pT < 70 GeV
   {1.19173,1.16122,1.13745,1.15087,1.1975,1.26218,1.36236,1.47277}, // 70 < jet pT < 80 GeV
   {1.1782,1.15206,1.13337,1.15277,1.1995,1.28481,1.385,1.5147}, // 80 < jet pT < 90 GeV
   {1.1696,1.14794,1.13648,1.16225,1.22193,1.30604,1.41588,1.53687}, // 90 < jet pT < 100 GeV
   {1.16048,1.1405,1.13426,1.16373,1.22868,1.32406,1.46306,1.64263}, // 100 < jet pT < 110 GeV
   {1.15245,1.13624,1.13529,1.1663,1.24066,1.362,1.50799,1.72346}, // 110 < jet pT < 120 GeV
   {1.14838,1.13554,1.1403,1.18135,1.26839,1.38524,1.53833,1.74622}, // 120 < jet pT < 140 GeV
   {1.14074,1.13163,1.14268,1.19401,1.28692,1.44164,1.65698,1.92096}, // 140 < jet pT < 160 GeV
   {1.13849,1.13451,1.15805,1.2171,1.33317,1.51229,1.75703,2.02628}, // 160 < jet pT < 180 GeV
   {1.13076,1.12906,1.1552,1.22648,1.35855,1.54999,1.82363,2.14832}, // 180 < jet pT < 200 GeV
   {1.13055,1.13194,1.16494,1.24691,1.38584,1.60098,1.91129,2.28722}, // 200 < jet pT < 220 GeV
   {1.12896,1.13287,1.16602,1.25153,1.40448,1.62071,1.92358,2.32008}, // 220 < jet pT < 240 GeV
   {1.12819,1.13429,1.17875,1.27628,1.44814,1.70791,2.0393,2.48746}, // 240 < jet pT < 260 GeV
   {1.1216,1.12824,1.17079,1.26978,1.43726,1.70086,2.02512,2.45522}, // 260 < jet pT < 280 GeV
   {1.12846,1.1387,1.191,1.29555,1.48145,1.77547,2.14429,2.63133}, // 280 < jet pT < 300 GeV
   {1.12649,1.1405,1.19874,1.32681,1.54328,1.8694,2.31755,2.86104}, // 300 < jet pT < 500 GeV
   {1.13046,1.15511,1.24363,1.4095,1.7024,2.15408,2.79249,3.56994}, // 500 < jet pT < 5020 GeV
   {1.18556,1.15849,1.13871,1.15583,1.20837,1.29247,1.4074,1.54538}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
   // Centrality 50-90%
  {{1.25613,1.27091,1.34583,1.49559,1.74116,2.05929,2.46228,2.92579}, // 60 < jet pT < 70 GeV
   {1.25054,1.2671,1.34308,1.50246,1.74156,2.05876,2.45802,2.85007}, // 70 < jet pT < 80 GeV
   {1.25313,1.27424,1.3619,1.5345,1.8116,2.17947,2.67228,3.15509}, // 80 < jet pT < 90 GeV
   {1.25396,1.27888,1.37503,1.56663,1.88924,2.33681,2.8351,3.28241}, // 90 < jet pT < 100 GeV
   {1.26227,1.29223,1.40813,1.6219,1.96151,2.45269,3.02255,3.7548}, // 100 < jet pT < 110 GeV
   {1.26761,1.30411,1.43189,1.66326,2.05745,2.63267,3.35483,4.17838}, // 110 < jet pT < 120 GeV
   {1.27121,1.3104,1.44483,1.69665,2.11016,2.72974,3.50465,4.42521}, // 120 < jet pT < 140 GeV
   {1.27999,1.32591,1.48133,1.77095,2.24791,2.9196,3.7555,4.68207}, // 140 < jet pT < 160 GeV
   {1.29032,1.3447,1.51674,1.83456,2.39456,3.21212,4.36874,5.64703}, // 160 < jet pT < 180 GeV
   {1.30182,1.35852,1.55018,1.91332,2.50677,3.37014,4.31973,5.3419}, // 180 < jet pT < 200 GeV
   {1.30461,1.36626,1.5638,1.94247,2.5404,3.42465,4.61089,6.03555}, // 200 < jet pT < 220 GeV
   {1.31794,1.38858,1.60786,2.01825,2.66745,3.62459,4.94741,6.48723}, // 220 < jet pT < 240 GeV
   {1.32715,1.40197,1.63904,2.11361,2.8713,4.06303,5.62714,7.52183}, // 240 < jet pT < 260 GeV
   {1.33896,1.4138,1.66715,2.13184,2.91769,3.99974,5.36053,6.82918}, // 260 < jet pT < 280 GeV
   {1.34076,1.42399,1.68564,2.17233,2.98996,4.24784,5.83604,7.87569}, // 280 < jet pT < 300 GeV
   {1.36758,1.45984,1.75199,2.30439,3.24604,4.72427,6.61035,8.85408}, // 300 < jet pT < 500 GeV
   {1.41955,1.54024,1.93062,2.66392,3.86968,5.63364,8.01449,10.7849}, // 500 < jet pT < 5020 GeV
   {1.25787,1.27995,1.37215,1.55407,1.84834,2.25037,2.75561,3.30386}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}} // 120 GeV < jet pT
  }}
  };
   
  
  // Copy the input values to the class array
  for(int iCentrality = 0; iCentrality < kNCentralityBins; iCentrality++){
    for(int iJetPt = 0; iJetPt < kNJetPtBins; iJetPt++){
      for(int iTrackPt = 0; iTrackPt < kNTrackPtBins; iTrackPt++){
        fBackgroundScale[iCentrality][iJetPt][iTrackPt] = energyEnergyCorrelatorBackgroundScaleFactors[iSystematic][useGenJets][iCentrality][iJetPt][iTrackPt];
      } // Track pT loop
    } // Jet pT loop
  } // Centrality loop

  // ================================================== //
  //                                                    // 
  //                 Tables for pp                      //
  //                                                    //
  // ================================================== //

  // For pp, the default option is to not subtractr background, since it is assumed to be negligible.
  // For systematic check, we provide numbers the are acquired from 85-95% PYTHIA+HYDJET simulation
  // This very peripheral bin should give a decent approximation for the scaling factors in pp

  // The first part of the array gives the results for reconstructed jets.
  // The macro used for the study is findBackgroundNormalizationScale.C
  // The file that was used to produce all the numbers is PbPbMC2018_RecoGen_eecAnalysis_akFlowJets_miniAOD_peripheralBins_noTrigger_cutBadPhi_noJetPtWeight_forBackgroundScale_processed_2023-06-06.root
  // Git hash: ab2fa4f4278049fc41e668400d1654f0c15be615

  double energyEnergyCorrelatorBackgroundScaleFactorsPp[2][20][8] =
  {
  {{4.58745,5.35941,8.01473,14.0303,25.7855,50.2083,98.8163,286.475}, // 60 < jet pT < 70 GeV
  {4.74257,5.59104,8.16176,14.1769,27.8535,72.8084,161.902,312.44}, // 70 < jet pT < 80 GeV
  {4.69831,5.62265,8.51227,14.25,26.2998,49.5523,118.293,431.057}, // 80 < jet pT < 90 GeV
  {5.00999,6.04347,9.64987,18.2766,32.6413,97.0844,286.32,730.111}, // 90 < jet pT < 100 GeV
  {5.30026,6.43662,10.327,19.4306,41.1585,82.0149,182.868,398.295}, // 100 < jet pT < 110 GeV
  {5.4632,6.71661,10.7952,18.427,36.5765,83.4401,169.638,492.78}, // 110 < jet pT < 120 GeV
  {5.8321,7.16483,11.5235,21.6059,43.7546,80.4965,274.01,1245.51}, // 120 < jet pT < 140 GeV
  {5.98009,7.46035,12.6091,26.729,57.7728,112.302,240.537,618.208}, // 140 < jet pT < 160 GeV
  {6.25546,7.80494,13.3514,26.1831,60.4526,145.731,431.796,1419.51}, // 160 < jet pT < 180 GeV
  {6.60095,8.25185,14.3678,30.9036,68.8567,171.137,406.091,859.747}, // 180 < jet pT < 200 GeV
  {6.50735,7.99483,13.6128,26.2324,50.3326,109.995,297.663,610.752}, // 200 < jet pT < 220 GeV
  {7.3337,9.40914,16.728,33.6867,96.015,229.464,347.535,469.932}, // 220 < jet pT < 240 GeV
  {7.34203,9.38437,16.7122,32.7869,73.5484,159.108,367.617,548.867}, // 240 < jet pT < 260 GeV
  {7.73611,10.0695,17.8309,37.3679,85.5466,162.828,438.605,18977.6}, // 260 < jet pT < 280 GeV
  {7.64584,9.76279,17.2105,34.3928,72.2878,124.153,346.396,656.995}, // 280 < jet pT < 300 GeV 
  {8.85882,11.69,21.7387,45.6162,92.2504,194.248,474.194,1216.92}, // 300 < jet pT < 500 GeV
  {9.66177,12.7929,23.486,44.8257,111.433,471.461,1009.59,2309.4}, // 500 < jet pT < 5020 GeV
  {4.91617,5.86689,9.00285,16.1059,31.0348,67.098,150.282,406.551}, // 60 GeV < jet pT
  {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
  {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}}, // 120 GeV < jet pT
  

  // The second part of the array gives the same numbers for a generator level jet study
  // The file used for the numbers: PbPbMC2018_GenGen_eecAnalysis_akFlowJets_miniAOD_peripheralBins_noTrigger_cutBadPhi_noJetPtWeight_forBackgroundScale_processed_2023-06-06.root
  // Git hash: ab2fa4f4278049fc41e668400d1654f0c15be615

  {{4.58745,5.35941,8.01473,14.0303,25.7855,50.2083,98.8163,286.475}, // 60 < jet pT < 70 GeV
   {4.74257,5.59104,8.16176,14.1769,27.8535,72.8084,161.902,312.44}, // 70 < jet pT < 80 GeV
   {4.69831,5.62265,8.51227,14.25,26.2998,49.5523,118.293,431.057}, // 80 < jet pT < 90 GeV
   {5.00999,6.04347,9.64987,18.2766,32.6413,97.0844,286.32,730.111}, // 90 < jet pT < 100 GeV
   {5.30026,6.43662,10.327,19.4306,41.1585,82.0149,182.868,398.295}, // 100 < jet pT < 110 GeV
   {5.4632,6.71661,10.7952,18.427,36.5765,83.4401,169.638,492.78}, // 110 < jet pT < 120 GeV
   {5.8321,7.16483,11.5235,21.6059,43.7546,80.4965,274.01,1245.51}, // 120 < jet pT < 140 GeV
   {5.98009,7.46035,12.6091,26.729,57.7728,112.302,240.537,618.208}, // 140 < jet pT < 160 GeV
   {6.25546,7.80494,13.3514,26.1831,60.4526,145.731,431.796,1419.51}, // 160 < jet pT < 180 GeV
   {6.60095,8.25185,14.3678,30.9036,68.8567,171.137,406.091,859.747}, // 180 < jet pT < 200 GeV
   {6.50735,7.99483,13.6128,26.2324,50.3326,109.995,297.663,610.752}, // 200 < jet pT < 220 GeV
   {7.3337,9.40914,16.728,33.6867,96.015,229.464,347.535,469.932}, // 220 < jet pT < 240 GeV
   {7.34203,9.38437,16.7122,32.7869,73.5484,159.108,367.617,548.867}, // 240 < jet pT < 260 GeV
   {7.73611,10.0695,17.8309,37.3679,85.5466,162.828,438.605,18977.6}, // 260 < jet pT < 280 GeV
   {7.64584,9.76279,17.2105,34.3928,72.2878,124.153,346.396,656.995}, // 280 < jet pT < 300 GeV
   {8.85882,11.69,21.7387,45.6162,92.2504,194.248,474.194,1216.92}, // 300 < jet pT < 500 GeV
   {9.66177,12.7929,23.486,44.8257,111.433,471.461,1009.59,2309.4}, // 500 < jet pT < 5020 GeV
   {4.91617,5.86689,9.00285,16.1059,31.0348,67.098,150.282,406.551}, // 60 GeV < jet pT
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}, // 200 < jet pT < 300 GeV
   {-1,     -1,     -1,     -1,     -1,     -1,     -1,     -1}} // 120 GeV < jet pT
  };

  // Copy the input values to the class array
  for(int iJetPt = 0; iJetPt < kNJetPtBins; iJetPt++){
    for(int iTrackPt = 0; iTrackPt < kNTrackPtBins; iTrackPt++){
      fBackgroundScalePp[iJetPt][iTrackPt] = energyEnergyCorrelatorBackgroundScaleFactorsPp[useGenJets][iJetPt][iTrackPt];
    } // Track pT loop
  } // Jet pT loop
  
}

/*
 * Get the background scaling factor for the systematic uncertainty study for pp
 *
 *  const std::pair<double,double> jetPtBinBorders = Jet pT bin borders for the scaling factor
 *  const double trackPtLowBorder = Lower track pT bin border for the scaling factor. All tracks above this are used
 *
 *  return: pp scaling factor corresponding to the bin with the given bin borders
 */
double EECBackgroundScale::GetEECBackgroundScalePp(const std::pair<double,double> jetPtBinBorders, const double trackPtLowBorder) const{
  
  // Small number
  const double epsilon = 0.0001;

  // Search if the given track pT bin borders are included in the background scale table
  int trackPtIndex = -1;
  for(int iTrackPt = 0; iTrackPt < kNTrackPtBins; iTrackPt++){
    if(TMath::Abs(fTrackPtBinBorderLow[iTrackPt] - trackPtLowBorder) < epsilon){
      trackPtIndex = iTrackPt;
      break;
    }
  } // Loop over track pT bins included in the scaling table

  // If track pT bin is not found, print an error message and return -1 to show we did not find a proper scaling factor.
  if(trackPtIndex == -1){
    std::cout << "EECBackgroundScale::Error! Track pT > " << trackPtLowBorder << " GeV bin was not found from the table." << std::endl;
    std::cout << "Cannot provide a background scaling factor. Please check your code for errors." << std::endl;
    return -1;
  }

  // Search if the given jet pT bin borders are included in the background scale table
  int jetPtIndex = -1;
  for(int iJetPt = 0; iJetPt < kNJetPtBins; iJetPt++){
    if(TMath::Abs(fJetPtBinBorderLow[iJetPt] - jetPtBinBorders.first) < epsilon){
      if(TMath::Abs(fJetPtBinBorderHigh[iJetPt] - jetPtBinBorders.second) < epsilon){
        jetPtIndex = iJetPt;
        break;
      }
    }
  } // Loop over jet pT bins included in the scaling table

  // If jet pT bin is not found, print an error message and return -1 to show we did not find a proper scaling factor.
  if(jetPtIndex == -1){
    std::cout << "EECBackgroundScale::Error! Jet pT bin " << jetPtBinBorders.first << "-" << jetPtBinBorders.second << " GeV was not found from the table." << std::endl;
    std::cout << "Cannot provide a background scaling factor. Please check your code for errors." << std::endl;
    return -1;
  }

  // *************************************************************************** //
  // After the correct bin has been found, return the corresponding scale factor //
  // *************************************************************************** //

  return fBackgroundScalePp[jetPtIndex][trackPtIndex];

}

/*
 * Get the background scaling factor for the given bin
 *
 *  const std::pair<double,double> centralityBinBorders = Centrality bin borders for the scaling factor
 *  const std::pair<double,double> jetPtBinBorders = Jet pT bin borders for the scaling factor
 *  const double trackPtLowBorder = Lower track pT bin border for the scaling factor. All tracks above this are used
 *  const bool isPbPbData = True for PbPb, false for pp
 *
 *  return: Scaling factor corresponding to the bin with the given bin borders
 */
double EECBackgroundScale::GetEECBackgroundScale(const std::pair<double,double> centralityBinBorders, const std::pair<double,double> jetPtBinBorders, const double trackPtLowBorder, const bool isPbPbData) const{

  // Use different numbers for pp
  if(!isPbPbData) return GetEECBackgroundScalePp(jetPtBinBorders, trackPtLowBorder);

  // ******************************************************************** //
  // First, find the bin indices that correspond to the input bin borders //
  // ******************************************************************** //

  // Small number
  const double epsilon = 0.0001;

  // For PbPb data, search if the given centrality bin borders are included in the background scale table
  int centralityIndex = -1;
  for(int iCentrality = 0; iCentrality < kNCentralityBins; iCentrality++){
    if(TMath::Abs(fCentralityBinBorderLow[iCentrality] - centralityBinBorders.first) < epsilon){
      if(TMath::Abs(fCentralityBinBorderHigh[iCentrality] - centralityBinBorders.second) < epsilon){
        centralityIndex = iCentrality;
        break;
      }
    }
    if(TMath::Abs(fCentralityBinBorderLowShifted[iCentrality] - centralityBinBorders.first) < epsilon){
      if(TMath::Abs(fCentralityBinBorderHighShifted[iCentrality] - centralityBinBorders.second) < epsilon){
        centralityIndex = iCentrality;
        break;
      }
    }
  } // Loop over centrality bins included in the scaling table

  // If centrality bin is not found, print an error message and return -1 to show we did not find a proper scaling factor.
  if(centralityIndex == -1){
    std::cout << "EECBackgroundScale::Error! Centrality bin " << centralityBinBorders.first << "-" << centralityBinBorders.second << " % was not found from the table." << std::endl;
    std::cout << "Cannot provide a background scaling factor. Please check your code for errors." << std::endl;
    return -1;
  }

  // Search if the given track pT bin borders are included in the background scale table
  int trackPtIndex = -1;
  for(int iTrackPt = 0; iTrackPt < kNTrackPtBins; iTrackPt++){
    if(TMath::Abs(fTrackPtBinBorderLow[iTrackPt] - trackPtLowBorder) < epsilon){
      trackPtIndex = iTrackPt;
      break;
    }
  } // Loop over track pT bins included in the scaling table

  // If track pT bin is not found, print an error message and return -1 to show we did not find a proper scaling factor.
  if(trackPtIndex == -1){
    std::cout << "EECBackgroundScale::Error! Track pT > " << trackPtLowBorder << " GeV bin was not found from the table." << std::endl;
    std::cout << "Cannot provide a background scaling factor. Please check your code for errors." << std::endl;
    return -1;
  }

  // Search if the given jet pT bin borders are included in the background scale table
  int jetPtIndex = -1;
  for(int iJetPt = 0; iJetPt < kNJetPtBins; iJetPt++){
    if(TMath::Abs(fJetPtBinBorderLow[iJetPt] - jetPtBinBorders.first) < epsilon){
      if(TMath::Abs(fJetPtBinBorderHigh[iJetPt] - jetPtBinBorders.second) < epsilon){
        jetPtIndex = iJetPt;
        break;
      }
    }
  } // Loop over jet pT bins included in the scaling table

  // If jet pT bin is not found, print an error message and return -1 to show we did not find a proper scaling factor.
  if(jetPtIndex == -1){
    std::cout << "EECBackgroundScale::Error! Jet pT bin " << jetPtBinBorders.first << "-" << jetPtBinBorders.second << " GeV was not found from the table." << std::endl;
    std::cout << "Cannot provide a background scaling factor. Please check your code for errors." << std::endl;
    return -1;
  }

  // *************************************************************************** //
  // After the correct bin has been found, return the corresponding scale factor //
  // *************************************************************************** //

  return fBackgroundScale[centralityIndex][jetPtIndex][trackPtIndex];

}
