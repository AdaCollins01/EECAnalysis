/*
 * Implementation of the ReflectedConeWeight class
 */

// Own includes
#include "ReflectedConeWeight.h"

/*
 * Define a piecewise linear function.
 *  parameters: par[0] = First piece divider. Needs to be fixed.
 *              par[1] = Second piece divider. Needs to be fixed.
 *              par[2] = Constant for the first piece
 *              par[3] = Slope for the first piece
 *              par[4] = Constant for the second piece
 *              par[5] = Slope for the second piece
 *              par[6] = Constant for the third piece
 *              par[7] = Slope for the third piece
 */
double piecewiseLinear(double *x, double *par){
  if(x[0] < par[0]) return par[2] + par[3]*x[0];
  if(x[0] > par[1]) return par[6] + par[7]*x[0];
  return par[4] + par[5]*x[0];
}

/*
 * Define a function that is exponential at low DeltaR and linear in high
 *  parameters: par[0] = Divider between linear and exponential components
 *              par[1] = Constant for the exponent
 *              par[2] = Scale for the exponent
 *              par[3] = Exponent
 *              par[4] = Contant for the linear part
 *              par[5] = Slope for the linear part
 */
double expoLinear(double *x, double *par){
  if(x[0] < par[0]) return par[1] + par[2] * TMath::Exp(-par[3] * x[0]);
  return par[4] + par[5] * x[0];
}

/*
 * Contructor
 */
ReflectedConeWeight::ReflectedConeWeight()
{
  fMonteCarloPiecewiseLinear = new TF1("monteCarloPiecewiseLinear", piecewiseLinear, 0, 0.6, 8);
  fMonteCarloExpoLinear = new TF1("monteCarloExpoLinear", expoLinear, 0, 0.6, 6);
  InitializeArrays();
}

/*
 * Destructor
 */
ReflectedConeWeight::~ReflectedConeWeight(){

}

/*
 * Initialization for seagull method arrays. Set all bins that need nonzero value
 */
void ReflectedConeWeight::InitializeArrays(){
  
  // ======================================================== //
  //                                                          //
  //  M     M   EEEEEE   TTTTTTT   H    H    OOOOO    DDDD    //
  //  MMM MMM   E           T      H    H   O     O   D   D   //
  //  M  M  M   EEEEEE      T      HHHHHH   O     O   D    D  //
  //  M     M   E           T      H    H   O     O   D   D   //
  //  M     M   EEEEEE      T      H    H    OOOOO    DDDD    //
  //                                                          //
  // ======================================================== //
  
  // Warning: the method has been checked only for 120 < jet pT < 140 GeV and 0-10 % centrality bin!
  // If it works in that bin, all the other bins will need to be rechecked.
  //
  // What is currently done, is that the signal particle density is divided into two regions, that are fitted
  // with a line. The regions are the "kink region", 0.34 < DeltaR < 0.44, and the "background region", 0.44 < DeltaR < 0.6
  // We assume that the particle density for the background throughout will follow the shape of the background region
  // in everywhere else except in the kink region, where it follows the shape of the kink region. We have also
  // fitted the particle density shape in the reflected cone within 0.05 < DeltaR < 0.5.
  //
  // To apply the weight, the reflected cone basic shape is taken into account, and additional weight is added on
  // top of that to make the reflected cone shape match with the background shape in the signal cone.
  // BGD = Background density. KD = Kink density. RCD = Reflected cone density
  //
  // The file that was used for the study is data/eecAnalysis_akFlowJets_removeBadAcceptance_wtaAxis_processed_2022-10-25.root
  // The macro for the study is particleDensityFitter.C
  
  // =======================================================================
  // == For signal cone, this is the BGD(DeltaR = 0) / BGD(DeltaR = 0.34) ==
  // =======================================================================
  
  double particleDensityPtBinned[4][7][8] = {
    // Centrality 0-10%
    {{1.03715,1.06107,1.09448,1.11818,1.16904,1.24356,1.30797,1.47422}, // 120 < jet pT < 140 GeV
      {1.03485,1.06486,1.09475,1.11883,1.17582,1.25746,1.33473,1.48767}, // 140 < jet pT < 160 GeV
      {1.0548,1.07493,1.07856,1.15852,1.17005,1.21852,1.27118,1.53213}, // 160 < jet pT < 180 GeV
      {1.04032,1.05537,1.09292,1.13319,1.11144,1.27421,1.25746,1.53812}, // 180 < jet pT < 200 GeV
      {1.04553,1.06528,1.08965,1.10083,1.13599,1.25247,1.24137,1.57262}, // 200 < jet pT < 300 GeV
      {1.05817,1.07609,1.06999,1.15767,1.15764,1.07978,1.31419,1.63778}, // 300 < jet pT < 500 GeV
      {1.13373,1.11026,1.12378,0.637375,0.980963,1.03702,1.92669,14.4891}}, // 500 < jet pT < 5020 GeV
    // Centrality 10-30%
    {{1.05156,1.08317,1.11909,1.15237,1.22908,1.25442,1.31647,1.55014}, // 120 < jet pT < 140 GeV
      {1.05598,1.08563,1.12896,1.16203,1.21976,1.27312,1.39177,1.63026}, // 140 < jet pT < 160 GeV
      {1.04015,1.07901,1.13128,1.17067,1.19572,1.32684,1.3499,1.5936}, // 160 < jet pT < 180 GeV
      {1.04827,1.0784,1.1361,1.17013,1.2098,1.23272,1.38883,1.66619}, // 180 < jet pT < 200 GeV
      {1.0325,1.08305,1.12816,1.16583,1.22409,1.35243,1.45061,1.65732}, // 200 < jet pT < 300 GeV
      {1.0743,1.08202,1.10218,1.08297,1.01662,1.37998,1.53247,1.75862}, // 300 < jet pT < 500 GeV
      {1.00842,1.28426,1.1829,1.50521,-0.115873,0.557432,1.66047,-0.681321}}, // 500 < jet pT < 5020 GeV
    // Centrality 30-50%
    {{1.06992,1.1141,1.17996,1.22621,1.28255,1.37186,1.54424,1.65992}, // 120 < jet pT < 140 GeV
      {1.09181,1.13607,1.21016,1.25016,1.33593,1.37461,1.55997,1.74541}, // 140 < jet pT < 160 GeV
      {1.06294,1.13414,1.18817,1.26763,1.37175,1.48958,1.52663,1.7646}, // 160 < jet pT < 180 GeV
      {1.02665,1.12624,1.15702,1.13182,1.49083,1.54615,1.59895,1.73059}, // 180 < jet pT < 200 GeV
      {1.11836,1.11096,1.21399,1.20476,1.29088,1.36134,1.39283,1.70273}, // 200 < jet pT < 300 GeV
      {1.13478,1.13885,1.1637,1.05514,1.5652,1.70816,1.77322,1.46233}, // 300 < jet pT < 500 GeV
      {0.822128,0.959372,1.84294,1.2499,1.95462,1.27786,-0.0557169,1.72203}}, // 500 < jet pT < 5020 GeV
    // Centrality 50-90%
    {{1.17063,1.23714,1.37509,1.48029,1.62406,1.58877,1.66833,1.85168}, // 120 < jet pT < 140 GeV
      {1.21553,1.28124,1.31239,1.4633,1.71336,1.72282,1.76285,1.87719}, // 140 < jet pT < 160 GeV
      {1.19425,1.23396,1.44234,1.54604,1.58989,1.29237,1.63028,1.95419}, // 160 < jet pT < 180 GeV
      {1.11314,1.24665,1.48834,1.65943,1.60079,1.86546,1.82767,2.04839}, // 180 < jet pT < 200 GeV
      {1.00121,1.21642,1.47881,1.43536,1.63387,1.62927,1.65165,1.82287}, // 200 < jet pT < 300 GeV
      {1.31225,1.32221,1.08278,1.11992,1.19511,0.338351,8.13283,1.37021}, // 300 < jet pT < 500 GeV
      {1.81099,1.07239,1.65551,2.0829,1.32638,1.45039,1.26522,2.07134}} // 500 < jet pT < 5020 GeV
  };
  
  // ==========================================================================
  // == For reflected cone, this is the RCD(DeltaR = 0) / RCD(DeltaR = 0.34) ==
  // ==========================================================================
  
  double particleDensityPtBinnedReflectedCone[4][7][8] = {
    // Centrality 0-10%
    {{1.02082,1.00862,1.01642,1.01515,1.01432,1.01606,1.00175,0.977148}, // 120 < jet pT < 140 GeV
      {1.01865,1.01014,1.01084,1.02183,1.01132,1.01743,1.01494,0.954175}, // 140 < jet pT < 160 GeV
      {1.02264,1.00819,1.00817,1.02303,1.01504,0.993528,1.0015,0.93633}, // 160 < jet pT < 180 GeV
      {1.01334,1.00689,1.00169,1.00844,1.00375,1.00659,0.924959,0.926645}, // 180 < jet pT < 200 GeV
      {1.01107,1.00693,1.00315,0.997835,1.02093,0.974936,0.995928,0.947067}, // 200 < jet pT < 300 GeV
      {1.01763,0.994131,0.979124,1.03165,1.01044,0.920156,0.889442,0.975322}, // 300 < jet pT < 500 GeV
      {1.03154,0.988376,0.891902,0.931592,0.785267,1.08857,1.79411,1.05325}}, // 500 < jet pT < 5020 GeV
    // Centrality 10-30%
    {{1.0238,1.01338,1.02008,1.01754,1.01021,1.01454,0.996103,0.948179}, // 120 < jet pT < 140 GeV
      {1.01828,1.01047,1.01417,1.02218,1.01015,0.998293,1.01471,0.902489}, // 140 < jet pT < 160 GeV
      {1.02516,1.01023,1.01009,1.0156,1.01338,1.00171,0.980917,0.904686}, // 160 < jet pT < 180 GeV
      {1.0227,1.01042,1.01133,1.03029,0.984111,1.0075,0.929582,0.864887}, // 180 < jet pT < 200 GeV
      {1.01775,1.01437,0.996733,1.01602,1.00932,1.01201,0.978764,0.839422}, // 200 < jet pT < 300 GeV
      {1.03797,1.00841,1.01821,1.03519,0.97356,0.942085,0.951721,0.784917}, // 300 < jet pT < 500 GeV
      {0.977463,1.00542,1.02743,1.00869,1.23815,1.50099,1.43687,1.68672}}, // 500 < jet pT < 5020 GeV
    // Centrality 30-50%
    {{1.01459,1.00239,1.00455,0.981497,0.989248,0.967323,0.936872,0.868135}, // 120 < jet pT < 140 GeV
      {1.03247,1.01844,0.99048,0.997131,0.962352,0.959492,0.992209,0.837536}, // 140 < jet pT < 160 GeV
      {1.02043,0.998105,0.99563,0.968784,1.02864,0.953518,0.905975,0.718988}, // 160 < jet pT < 180 GeV
      {1.01345,0.998425,0.997992,0.990203,0.958247,0.79677,0.85976,0.688165}, // 180 < jet pT < 200 GeV
      {0.992513,0.998578,0.985573,0.977705,0.972259,0.892676,0.84765,0.822296}, // 200 < jet pT < 300 GeV
      {0.951206,1.00538,0.990178,0.902898,1.01015,0.750032,0.280739,0.563559}, // 300 < jet pT < 500 GeV
      {0.891639,0.758953,0.883179,0.928523,1.85112,1.83924,2.12026,1.72923}}, // 500 < jet pT < 5020 GeV
    // Centrality 50-90%
    {{0.985088,1.00918,0.985538,0.940368,0.908459,0.767333,0.816034,0.619181}, // 120 < jet pT < 140 GeV
      {0.993021,0.980018,0.954558,0.895924,0.880789,0.681584,0.979857,0.578747}, // 140 < jet pT < 160 GeV
      {0.979499,1.02443,0.917511,0.953081,0.668039,0.749618,0.568544,0.650549}, // 160 < jet pT < 180 GeV
      {1.08008,0.959395,0.952771,0.942338,0.555029,0.499021,1.18723,0.486642}, // 180 < jet pT < 200 GeV
      {0.962675,0.915826,0.896399,0.965635,0.575113,0.956269,0.37644,0.283039}, // 200 < jet pT < 300 GeV
      {0.84009,0.842098,0.921152,1.09828,0.998449,1.29171,1.17712,1.10162}, // 300 < jet pT < 500 GeV
      {2.46241,1.73441,2.00884,2.35006,1.83857,2.48267,-1,5.1498}} // 500 < jet pT < 5020 GeV
  };
  
  // =======================================================================
  // == For signal cone, this is the KD(DeltaR = 0.34) / KD(DeltaR = 0.4) ==
  // =======================================================================
  double particleDensityPtBinnedKink[4][7][8] = {
    // Centrality 0-10%
    {{1.01956,1.03241,1.04839,1.06856,1.08588,1.11997,1.17462,1.28525}, // 120 < jet pT < 140 GeV
      {1.02127,1.03596,1.05271,1.07004,1.11401,1.15368,1.16052,1.34573}, // 140 < jet pT < 160 GeV
      {1.02387,1.03685,1.05011,1.07976,1.10573,1.14527,1.14068,1.34169}, // 160 < jet pT < 180 GeV
      {1.02582,1.02923,1.04774,1.07072,1.10056,1.14352,1.19858,1.40839}, // 180 < jet pT < 200 GeV
      {1.01785,1.03732,1.04849,1.07056,1.11744,1.14266,1.1558,1.37441}, // 200 < jet pT < 300 GeV
      {1.00627,1.03256,1.05228,1.05611,1.08365,1.23619,1.14564,1.46196}, // 300 < jet pT < 500 GeV
      {0.959969,0.982598,1.04342,1.30286,1.00475,1.17881,0.876961,1.83153}}, // 500 < jet pT < 5020 GeV
    // Centrality 10-30%
    {{1.02395,1.03951,1.06131,1.09065,1.12975,1.16352,1.21913,1.35333}, // 120 < jet pT < 140 GeV
      {1.02884,1.0405,1.07048,1.10318,1.12187,1.17087,1.22957,1.38244}, // 140 < jet pT < 160 GeV
      {1.02708,1.04445,1.07056,1.0936,1.12721,1.17368,1.23968,1.41247}, // 160 < jet pT < 180 GeV
      {1.01572,1.04758,1.0712,1.09351,1.13567,1.17539,1.21135,1.42362}, // 180 < jet pT < 200 GeV
      {1.03024,1.03774,1.0665,1.09791,1.11737,1.18229,1.26962,1.46026}, // 200 < jet pT < 300 GeV
      {1.01542,1.03429,1.05216,1.0916,1.14318,1.17209,1.2266,1.50431}, // 300 < jet pT < 500 GeV
      {0.999292,1.06331,1.13128,1.39252,0.860853,0.804866,1.00156,1.55059}}, // 500 < jet pT < 5020 GeV
    // Centrality 30-50%
    {{1.03259,1.06135,1.09904,1.13689,1.18594,1.20406,1.30674,1.46526}, // 120 < jet pT < 140 GeV
      {1.04369,1.06251,1.09863,1.1436,1.20815,1.25224,1.33174,1.51462}, // 140 < jet pT < 160 GeV
      {1.02079,1.05696,1.10183,1.10483,1.15322,1.29897,1.34689,1.50899}, // 160 < jet pT < 180 GeV
      {1.04224,1.05543,1.09219,1.15402,1.16793,1.24301,1.2559,1.55678}, // 180 < jet pT < 200 GeV
      {1.03616,1.05156,1.07223,1.17912,1.16249,1.21022,1.3317,1.49531}, // 200 < jet pT < 300 GeV
      {1.01021,1.08254,1.06674,1.12047,1.1412,1.25265,0.98907,1.6675}, // 300 < jet pT < 500 GeV
      {0.751401,1.18767,1.42633,1.04446,1.08159,1.22675,0.829435,1.52272}}, // 500 < jet pT < 5020 GeV
    // Centrality 50-90%
    {{1.08866,1.0919,1.18341,1.2572,1.30058,1.35086,1.41097,1.51184}, // 120 < jet pT < 140 GeV
      {1.07445,1.10666,1.19488,1.21595,1.2809,1.33918,1.40624,1.54237}, // 140 < jet pT < 160 GeV
      {1.06253,1.10385,1.11587,1.10688,1.35489,1.27738,1.51023,1.49006}, // 160 < jet pT < 180 GeV
      {1.07904,1.13127,1.1582,1.34338,1.33199,1.39426,1.33704,1.49161}, // 180 < jet pT < 200 GeV
      {1.06651,1.10501,1.17877,1.22793,1.38095,1.20649,1.5489,1.60173}, // 200 < jet pT < 300 GeV
      {0.932784,1.084,1.02406,1.16905,1.57546,1.44441,2.06656,1.49769}, // 300 < jet pT < 500 GeV
      {0.655846,1.0258,0.983349,0.570278,1.04107,-1,2.06656,1.21683}} // 500 < jet pT < 5020 GeV
  };
  
  // ===============================================
  // == Copy the input arrays to the class arrays ==
  // ===============================================
  
  for(int iCentrality = 0; iCentrality < kNCentralityBins; iCentrality++){
    for(int iJetPt = 0; iJetPt < kNJetPtBins; iJetPt++){
      for(int iTrackPt = 0; iTrackPt < kNTrackPtBins; iTrackPt++){
        fSignalConeMainShape[iCentrality][iJetPt][iTrackPt] = particleDensityPtBinned[iCentrality][iJetPt][iTrackPt];
        fSignalConeKink[iCentrality][iJetPt][iTrackPt] = particleDensityPtBinnedKink[iCentrality][iJetPt][iTrackPt];
        fReflectedConeShape[iCentrality][iJetPt][iTrackPt] = particleDensityPtBinnedReflectedCone[iCentrality][iJetPt][iTrackPt];
      } // Track pT loop
    } // Jet pT loop
  } // Centrality loop
  
  // ======================================================== //
  //                                                          //
  //  M     M   EEEEEE   TTTTTTT   H    H    OOOOO    DDDD    //
  //  MMM MMM   E           T      H    H   O     O   D   D   //
  //  M  M  M   EEEEEE      T      HHHHHH   O     O   D    D  //
  //  M     M   E           T      H    H   O     O   D   D   //
  //  M     M   EEEEEE      T      H    H    OOOOO    DDDD    //
  //                                                          //
  // ======================================================== //
  
  // Warning: the method has been checked only for 120 < jet pT < 140 GeV and 0-10 % centrality bin!
  // If it works in that bin, all the other bins will need to be rechecked.
  //
  // For Monte Carlo, we do a piecewise fit for the Hydjet only. After the fit is performed, the fit is scaled
  // in such a way that the fit value is 1 at 0.4. After this is done, the fit values can be directly used
  // as a weight for the tracks in the reflected cone.
  //
  // The file that was used for the study is data/PbPbMC2018_RecoGen_eecAnalysis_akFlowJet_updatedMultiplicityAndDensity_wtaAxis_noTrigger_preprocessed_2022-10-17.root
  // The macro for the study is particleDensityFitter.C
  
  double particleDensityPtBinnedMonteCarloParameters[8][4][7][8] = {
    // ============= Paramater 0 =============
    {
      // Centrality 0-10%
      {{0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 120 < jet pT < 140 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 140 < jet pT < 160 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 160 < jet pT < 180 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 180 < jet pT < 200 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 200 < jet pT < 300 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 300 < jet pT < 500 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}}, // 500 < jet pT < 5020 GeV
      // Centrality 10-30%
      {{0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 120 < jet pT < 140 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 140 < jet pT < 160 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 160 < jet pT < 180 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 180 < jet pT < 200 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 200 < jet pT < 300 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 300 < jet pT < 500 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}}, // 500 < jet pT < 5020 GeV
      // Centrality 30-50%
      {{0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 120 < jet pT < 140 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 140 < jet pT < 160 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 160 < jet pT < 180 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 180 < jet pT < 200 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 200 < jet pT < 300 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 300 < jet pT < 500 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}}, // 500 < jet pT < 5020 GeV
      // Centrality 50-90%
      {{0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 120 < jet pT < 140 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 140 < jet pT < 160 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 160 < jet pT < 180 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 180 < jet pT < 200 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 200 < jet pT < 300 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}, // 300 < jet pT < 500 GeV
        {0.34,0.34,0.34,0.34,0.34,0.34,0.34,0.1}} // 500 < jet pT < 5020 GeV
    },
    // ============= Paramater 1 =============
    {
      // Centrality 0-10%
      {{0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.42632}, // 120 < jet pT < 140 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.29184}, // 140 < jet pT < 160 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.44517}, // 160 < jet pT < 180 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.27148}, // 180 < jet pT < 200 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.23481}, // 200 < jet pT < 300 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,0.960406}, // 300 < jet pT < 500 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,-0.503867}}, // 500 < jet pT < 5020 GeV
      // Centrality 10-30%
      {{0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.46496}, // 120 < jet pT < 140 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.26474}, // 140 < jet pT < 160 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.38095}, // 160 < jet pT < 180 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,-34.4719}, // 180 < jet pT < 200 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,0.257039}, // 200 < jet pT < 300 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.33887}, // 300 < jet pT < 500 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,-0.902015}}, // 500 < jet pT < 5020 GeV
      // Centrality 30-50%
      {{0.45,0.45,0.45,0.45,0.45,0.45,0.45,0.941368}, // 120 < jet pT < 140 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.45441}, // 140 < jet pT < 160 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.35607}, // 160 < jet pT < 180 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.25653}, // 180 < jet pT < 200 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,-0.517449}, // 200 < jet pT < 300 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,1.16943}, // 300 < jet pT < 500 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,-1.88811}}, // 500 < jet pT < 5020 GeV
      // Centrality 50-90%
      {{0.45,0.45,0.45,0.45,0.45,0.45,0.45,-26.0091}, // 120 < jet pT < 140 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,0.670774}, // 140 < jet pT < 160 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,-0.154732}, // 160 < jet pT < 180 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,-441.802}, // 180 < jet pT < 200 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,-162.204}, // 200 < jet pT < 300 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,-3.03279}, // 300 < jet pT < 500 GeV
        {0.45,0.45,0.45,0.45,0.45,0.45,0.45,-7.34078}} // 500 < jet pT < 5020 GeV
    },
    // ============= Paramater 2 =============
    {
      // Centrality 0-10%
      {{1.01795,1.04337,1.0645,1.13271,1.21626,1.37057,1.49939,68.2082}, // 120 < jet pT < 140 GeV
        {1.0159,1.02017,1.05064,1.11751,1.17878,1.3953,1.54141,86.963}, // 140 < jet pT < 160 GeV
        {1.0239,1.02769,1.04248,1.11163,1.05332,1.37228,1.2831,112.421}, // 160 < jet pT < 180 GeV
        {1.00252,1.01804,1.00457,1.0799,1.02056,1.18096,1.21319,139.913}, // 180 < jet pT < 200 GeV
        {1.00668,1.01808,1.02481,1.08005,1.06864,1.12562,1.10656,51.0914}, // 200 < jet pT < 300 GeV
        {1.00584,1.00081,1.02285,1.0362,1.07656,1.03062,1.09567,0.0140563}, // 300 < jet pT < 500 GeV
        {0.993017,0.997534,1.00971,1.02576,0.989705,1.02692,1.06065,1.61549}}, // 500 < jet pT < 5020 GeV
      // Centrality 10-30%
      {{1.02652,1.04918,1.05217,1.14874,1.17087,1.26901,1.42281,76.9688}, // 120 < jet pT < 140 GeV
        {1.01106,1.03728,1.05402,1.13102,1.12061,1.19061,1.27999,50.718}, // 140 < jet pT < 160 GeV
        {1.01932,1.03584,1.0234,1.08137,1.1159,1.12489,1.16102,94.7258}, // 160 < jet pT < 180 GeV
        {1.02017,1.02191,1.02896,1.06578,1.07028,1.11873,1.08132,45.1064}, // 180 < jet pT < 200 GeV
        {1.01587,1.01993,1.0341,1.06035,1.08361,1.07938,1.10103,17.1898}, // 200 < jet pT < 300 GeV
        {0.997801,1.0332,1.03154,1.04323,1.05623,1.08186,1.13047,-26.1453}, // 300 < jet pT < 500 GeV
        {1.00845,1.01333,1.02139,1.0459,1.03803,1.05482,1.06053,2.14431}}, // 500 < jet pT < 5020 GeV
      // Centrality 30-50%
      {{1.0315,1.04414,1.07807,1.09681,1.19938,1.33449,1.43962,79.9645}, // 120 < jet pT < 140 GeV
        {1.01731,1.02965,1.05503,1.1424,1.09026,1.15933,1.36498,267.074}, // 140 < jet pT < 160 GeV
        {1.01848,1.03353,1.07508,1.06066,1.08853,1.14476,1.09147,231.7}, // 160 < jet pT < 180 GeV
        {1.01733,1.032,1.04661,1.05511,1.04774,1.03831,1.17359,219.086}, // 180 < jet pT < 200 GeV
        {1.01699,1.02414,1.01976,1.08168,1.05728,1.09746,1.18193,80.4118}, // 200 < jet pT < 300 GeV
        {1.01225,1.02456,1.02923,1.06243,1.04494,1.03406,1.0478,130.178}, // 300 < jet pT < 500 GeV
        {0.999919,1.01323,1.01449,1.01392,1.07218,0.991639,0.956275,3.18455}}, // 500 < jet pT < 5020 GeV
      // Centrality 50-90%
      {{1.02628,1.0525,1.10259,1.12845,1.13492,1.03989,1.26272,59.6775}, // 120 < jet pT < 140 GeV
        {1.00942,1.01325,1.06721,1.14918,1.13929,1.02765,1.29836,17.0655}, // 140 < jet pT < 160 GeV
        {1.04103,1.03926,1.02608,1.05917,1.05272,1.02687,1.29937,0.391201}, // 160 < jet pT < 180 GeV
        {1.03553,1.03248,1.0474,1.06793,1.08239,1.1305,0.867276,441.619}, // 180 < jet pT < 200 GeV
        {1.02295,1.0234,1.05898,1.07406,1.07872,1.00896,1.12575,163.787}, // 200 < jet pT < 300 GeV
        {1.00778,1.0089,1.02646,1.02834,0.998393,1.03672,1.11406,4.37831}, // 300 < jet pT < 500 GeV
        {1.01319,0.996625,1.00527,1.06767,0.940679,0.958919,1.10337,8.50309}} // 500 < jet pT < 5020 GeV
    },
    // ============= Paramater 3 =============
    {
      // Centrality 0-10%
      {{-0.0243766,-0.0652771,-0.109862,-0.260058,-0.4669,-0.92712,-1.25993,65.5308}, // 120 < jet pT < 140 GeV
        {-0.00133388,-0.0116639,-0.06538,-0.216745,-0.42562,-0.851976,-1.34586,60.7844}, // 140 < jet pT < 160 GeV
        {-0.0303981,-0.0302961,-0.00973134,-0.216276,-0.0322858,-0.704365,-0.567467,75.4526}, // 160 < jet pT < 180 GeV
        {0.0133777,-0.034217,0.0664567,-0.127572,0.00764955,-0.191603,-0.302836,70.7358}, // 180 < jet pT < 200 GeV
        {0.00372143,-0.00536766,0.00350963,-0.114153,-0.0576614,-0.168993,-0.0939878,73.5348}, // 200 < jet pT < 300 GeV
        {0.00651955,0.0256773,0.003618,-0.0233247,-0.120626,0.00182135,-0.0942506,-26.9335}, // 300 < jet pT < 500 GeV
        {0.051699,0.00546148,0.0245184,-0.000331989,0.0228052,-0.0311429,-0.0573685,-0.0555501}}, // 500 < jet pT < 5020 GeV
      // Centrality 10-30%
      {{-0.0253471,-0.0641143,-0.0644629,-0.285018,-0.35004,-0.511941,-0.97386,74.0794}, // 120 < jet pT < 140 GeV
        {0.00435289,-0.0468745,-0.0672033,-0.241476,-0.167626,-0.334348,-0.550333,56.1363}, // 140 < jet pT < 160 GeV
        {-0.0115663,-0.0383704,0.0179165,-0.10213,-0.205785,-0.161032,-0.272445,112.864}, // 160 < jet pT < 180 GeV
        {-0.0207842,-0.00788118,-0.00760987,-0.0621234,-0.0845938,-0.198495,-0.0449542,2.30997}, // 180 < jet pT < 200 GeV
        {-0.0194092,-0.0182849,-0.0254263,-0.0649681,-0.119275,-0.073417,-0.143236,28.1105}, // 200 < jet pT < 300 GeV
        {0.00734326,-0.0173649,-0.0277622,-0.0566018,-0.0425589,-0.0658705,-0.224113,51.7827}, // 300 < jet pT < 500 GeV
        {-0.00758845,-0.0119489,-0.0310545,-0.0619539,-0.0546209,-0.0361732,-0.00685587,0.550903}}, // 500 < jet pT < 5020 GeV
      // Centrality 30-50%
      {{-0.0336115,-0.0234302,-0.102375,-0.131622,-0.331426,-0.741689,-0.951463,49.3367}, // 120 < jet pT < 140 GeV
        {-0.0218132,-0.00386644,-0.0503755,-0.282886,-0.0814812,-0.197499,-0.690279,108.821}, // 140 < jet pT < 160 GeV
        {-0.0222141,-0.0120747,-0.115167,-0.0419157,-0.132716,-0.237695,-0.130026,98.0072}, // 160 < jet pT < 180 GeV
        {0.00140712,-0.0350849,-0.0495785,-0.0352951,0.021082,-0.0210458,-0.174539,85.3692}, // 180 < jet pT < 200 GeV
        {-0.00080038,0.00887304,0.0254138,-0.104168,-0.0501087,-0.109588,-0.328892,38.1248}, // 200 < jet pT < 300 GeV
        {0.00282411,-0.0193101,-0.0307285,-0.105868,-0.0220456,0.0865969,-0.0639636,265.208}, // 300 < jet pT < 500 GeV
        {0.00744358,-0.00451205,0.00246813,0.0339182,-0.0836848,0.130432,0.0285618,0.551003}}, // 500 < jet pT < 5020 GeV
      // Centrality 50-90%
      {{-0.0305905,-0.0515336,-0.142303,-0.196184,-0.170056,0.137347,-0.475364,7.72553}, // 120 < jet pT < 140 GeV
        {0.0066678,0.0259932,-0.0885861,-0.326009,-0.211644,0.110141,-0.538207,31.1045}, // 140 < jet pT < 160 GeV
        {-0.0859266,-0.0502829,0.0403196,-0.0332905,-0.0835791,-0.0566406,-0.709256,-13.8491}, // 160 < jet pT < 180 GeV
        {-0.0254292,-0.0287653,-0.0548144,-0.0684868,-0.0509567,0.0648325,0.573751,-0.0335157}, // 180 < jet pT < 200 GeV
        {-0.021654,-0.0133508,-0.0434883,-0.118956,-0.0276767,0.00409458,-0.197284,0.0171991}, // 200 < jet pT < 300 GeV
        {0.00512684,0.0172025,-0.00348399,-0.00179909,0.0401561,0.0175408,0.0212283,0.297894}, // 300 < jet pT < 500 GeV
        {-0.0222832,0.0111447,-0.00820073,-0.0995829,0.208911,0.421543,-0.192067,0.109623}} // 500 < jet pT < 5020 GeV
    },
    // ============= Paramater 4 =============
    {
      // Centrality 0-10%
      {{1.06443,1.14116,1.18097,1.29526,1.38344,1.36901,1.47346,1.69809}, // 120 < jet pT < 140 GeV
        {1.10298,1.10803,1.18942,1.29208,1.22714,1.70422,1.55878,1.65484}, // 140 < jet pT < 160 GeV
        {1.09045,1.11596,1.26116,1.25398,1.28227,1.88528,1.6011,1.6728}, // 160 < jet pT < 180 GeV
        {1.04712,1.04268,1.18111,1.24347,1.15439,1.77213,1.73485,1.52002}, // 180 < jet pT < 200 GeV
        {1.05299,1.1084,1.17333,1.27495,1.32691,1.45441,1.49733,1.3567}, // 200 < jet pT < 300 GeV
        {1.05372,1.06359,1.16051,1.18844,1.23699,1.20824,1.42418,1.22423}, // 300 < jet pT < 500 GeV
        {1.07063,0.995939,1.1203,1.17098,0.983057,1.10887,1.27428,1.16083}}, // 500 < jet pT < 5020 GeV
      // Centrality 10-30%
      {{1.11935,1.18256,1.20171,1.34558,1.34571,1.63303,1.61135,1.68218}, // 120 < jet pT < 140 GeV
        {1.08361,1.14228,1.2078,1.32611,1.4241,1.51286,1.61921,1.59967}, // 140 < jet pT < 160 GeV
        {1.1026,1.15193,1.19661,1.31096,1.3062,1.46761,1.45594,1.50952}, // 160 < jet pT < 180 GeV
        {1.08733,1.12817,1.17581,1.29772,1.27681,1.34158,1.44023,1.4412}, // 180 < jet pT < 200 GeV
        {1.0618,1.09139,1.1697,1.25504,1.28704,1.36282,1.34888,1.38781}, // 200 < jet pT < 300 GeV
        {1.00199,1.18196,1.14732,1.15991,1.2784,1.39644,1.36179,1.25529}, // 300 < jet pT < 500 GeV
        {1.03913,1.06177,1.07219,1.16557,1.12975,1.28349,1.38796,1.16981}}, // 500 < jet pT < 5020 GeV
      // Centrality 30-50%
      {{1.13381,1.24116,1.28842,1.34709,1.57795,1.54877,1.77412,1.68949}, // 120 < jet pT < 140 GeV
        {1.06599,1.18888,1.25267,1.30813,1.41704,1.61452,1.86859,1.61258}, // 140 < jet pT < 160 GeV
        {1.07282,1.19619,1.23946,1.30941,1.28936,1.42632,1.31511,1.49188}, // 160 < jet pT < 180 GeV
        {1.11869,1.13379,1.19833,1.28742,1.36608,1.20773,1.76162,1.39933}, // 180 < jet pT < 200 GeV
        {1.11143,1.18107,1.18934,1.30844,1.26827,1.40133,1.4674,1.34551}, // 200 < jet pT < 300 GeV
        {1.08806,1.11995,1.12519,1.17623,1.24964,1.42338,1.17371,1.22591}, // 300 < jet pT < 500 GeV
        {1.01633,1.07796,1.10222,1.16969,1.2915,1.23991,0.773239,1.16762}}, // 500 < jet pT < 5020 GeV
      // Centrality 50-90%
      {{1.10583,1.23318,1.36139,1.41164,1.514,1.57728,1.67399,1.73593}, // 120 < jet pT < 140 GeV
        {1.0779,1.14725,1.24729,1.25561,1.44888,1.43399,1.7691,1.57542}, // 140 < jet pT < 160 GeV
        {1.07878,1.14774,1.26524,1.319,1.16204,1.05073,1.38815,1.54386}, // 160 < jet pT < 180 GeV
        {1.17923,1.15136,1.19174,1.29764,1.43377,2.01695,1.41568,1.39885}, // 180 < jet pT < 200 GeV
        {1.1039,1.12572,1.29463,1.22413,1.46204,1.06904,1.39118,1.40189}, // 200 < jet pT < 300 GeV
        {1.06348,1.09836,1.16847,1.18483,1.08031,1.28453,1.80855,1.28936}, // 300 < jet pT < 500 GeV
        {1.03744,1.00276,1.01653,1.22543,1.07806,1.68163,1.25378,1.0928}} // 500 < jet pT < 5020 GeV
    },
    // ============= Paramater 5 =============
    {
      // Centrality 0-10%
      {{-0.161086,-0.352888,-0.452419,-0.738152,-0.958593,-0.922523,-1.18366,-1.74523}, // 120 < jet pT < 140 GeV
        {-0.257444,-0.270079,-0.473538,-0.730196,-0.56784,-1.76054,-1.39696,-1.63711}, // 140 < jet pT < 160 GeV
        {-0.226113,-0.289895,-0.65291,-0.634939,-0.705666,-2.21321,-1.50275,-1.682}, // 160 < jet pT < 180 GeV
        {-0.117807,-0.106695,-0.452778,-0.608685,-0.385975,-1.93031,-1.83712,-1.30006}, // 180 < jet pT < 200 GeV
        {-0.132479,-0.270998,-0.433331,-0.687381,-0.817276,-1.13604,-1.24332,-0.891761}, // 200 < jet pT < 300 GeV
        {-0.1343,-0.158978,-0.401273,-0.471095,-0.592474,-0.520594,-1.06045,-0.560579}, // 300 < jet pT < 500 GeV
        {-0.176582,0.010152,-0.30074,-0.427447,0.0423587,-0.272178,-0.685692,-0.402084}}, // 500 < jet pT < 5020 GeV
      // Centrality 10-30%
      {{-0.298366,-0.456392,-0.504281,-0.863945,-0.864263,-1.58257,-1.52837,-1.70544}, // 120 < jet pT < 140 GeV
        {-0.209027,-0.355689,-0.519502,-0.815268,-1.06026,-1.28215,-1.54802,-1.49917}, // 140 < jet pT < 160 GeV
        {-0.256497,-0.379825,-0.491524,-0.777405,-0.765494,-1.16902,-1.13985,-1.2738}, // 160 < jet pT < 180 GeV
        {-0.218317,-0.320429,-0.439537,-0.7443,-0.692022,-0.853949,-1.10056,-1.103}, // 180 < jet pT < 200 GeV
        {-0.154505,-0.228484,-0.424253,-0.637607,-0.717605,-0.90705,-0.872192,-0.969535}, // 200 < jet pT < 300 GeV
        {-0.00496798,-0.454904,-0.368296,-0.399782,-0.696004,-0.991107,-0.904469,-0.638237}, // 300 < jet pT < 500 GeV
        {-0.0978133,-0.154434,-0.180471,-0.413915,-0.324371,-0.708734,-0.969908,-0.424517}}, // 500 < jet pT < 5020 GeV
      // Centrality 30-50%
      {{-0.334519,-0.602895,-0.721047,-0.86772,-1.44487,-1.37192,-1.93531,-1.72372}, // 120 < jet pT < 140 GeV
        {-0.164974,-0.472198,-0.631668,-0.770319,-1.0426,-1.5363,-2.17147,-1.53144}, // 140 < jet pT < 160 GeV
        {-0.182055,-0.490486,-0.598654,-0.773518,-0.723399,-1.06579,-0.787763,-1.22971}, // 160 < jet pT < 180 GeV
        {-0.296729,-0.33448,-0.495836,-0.718558,-0.915197,-0.519319,-1.90405,-0.998321}, // 180 < jet pT < 200 GeV
        {-0.278579,-0.452678,-0.473346,-0.771105,-0.670666,-1.00332,-1.1685,-0.863766}, // 200 < jet pT < 300 GeV
        {-0.220148,-0.299887,-0.312963,-0.440583,-0.624099,-1.05844,-0.434278,-0.564769}, // 300 < jet pT < 500 GeV
        {-0.0408276,-0.194889,-0.255552,-0.424224,-0.728745,-0.59977,0.566903,-0.419046}}, // 500 < jet pT < 5020 GeV
      // Centrality 50-90%
      {{-0.264575,-0.582958,-0.903467,-1.0291,-1.285,-1.4432,-1.68499,-1.83983}, // 120 < jet pT < 140 GeV
        {-0.194762,-0.368123,-0.618229,-0.639031,-1.12221,-1.08498,-1.92275,-1.43856}, // 140 < jet pT < 160 GeV
        {-0.196953,-0.369359,-0.663109,-0.797497,-0.405106,-0.126817,-0.970386,-1.35966}, // 160 < jet pT < 180 GeV
        {-0.448077,-0.378388,-0.479357,-0.744109,-1.08443,-2.54237,-1.03919,-0.997125}, // 180 < jet pT < 200 GeV
        {-0.259745,-0.314288,-0.736578,-0.560331,-1.1551,-0.172593,-0.977938,-1.00473}, // 200 < jet pT < 300 GeV
        {-0.15869,-0.245897,-0.421186,-0.462065,-0.200763,-0.711336,-2.02136,-0.723406}, // 300 < jet pT < 500 GeV
        {-0.0935908,-0.00690834,-0.0413259,-0.563566,-0.195151,-1.70406,-0.634457,-0.232006}} // 500 < jet pT < 5020 GeV
    },
    // ============= Paramater 6 =============
    {
      // Centrality 0-10%
      {{1.01835,1.0243,1.04555,1.09283,1.09187,1.0466,1.08399,0}, // 120 < jet pT < 140 GeV
        {1.00133,1.05009,1.02407,1.01483,1.19348,1.0652,1.04292,0}, // 140 < jet pT < 160 GeV
        {1.00282,1.07687,1.04605,1.0333,1.16166,0.913204,0.959019,0}, // 160 < jet pT < 180 GeV
        {1.03309,1.05076,1.04255,1.14044,1.02379,1.04417,0.992506,0}, // 180 < jet pT < 200 GeV
        {1.01121,0.998537,1.0131,1.00428,1.00295,1.02925,1.0284,0}, // 200 < jet pT < 300 GeV
        {0.986699,1.0082,0.994138,1.01018,1.02639,1.03805,1.03898,0}, // 300 < jet pT < 500 GeV
        {0.89162,1.01257,0.974633,0.941827,1.09407,0.96974,0.962361,0}}, // 500 < jet pT < 5020 GeV
      // Centrality 10-30%
      {{1.02307,1.02363,0.996991,1.02277,1.02308,1.05665,1.35023,0}, // 120 < jet pT < 140 GeV
        {1.02342,1.02234,1.0318,0.995698,1.09871,1.02167,0.950068,0}, // 140 < jet pT < 160 GeV
        {0.995893,0.979068,0.999533,1.0141,1.02514,1.04935,0.920769,0}, // 160 < jet pT < 180 GeV
        {0.996408,0.999789,1.00173,0.997537,0.987118,0.984398,1.04118,0}, // 180 < jet pT < 200 GeV
        {1.0008,1.00267,1.00045,1.03395,1.0031,1.00988,1.13644,0}, // 200 < jet pT < 300 GeV
        {1.01899,0.999785,1.00136,1.01044,1.02168,0.977609,1.00255,0}, // 300 < jet pT < 500 GeV
        {1.00633,1.00603,1.00031,1.02206,0.988648,1.02937,1.02661,0}}, // 500 < jet pT < 5020 GeV
      // Centrality 30-50%
      {{1.02444,0.983507,0.993723,1.0237,1.04371,1.08937,0.943062,0}, // 120 < jet pT < 140 GeV
        {1.00456,0.962796,0.999942,1.03675,1.00491,0.950629,1.08903,0}, // 140 < jet pT < 160 GeV
        {0.969936,0.968462,1.00146,0.994173,1.02391,1.0661,0.928665,0}, // 160 < jet pT < 180 GeV
        {0.95892,1.01942,1.05233,0.998422,1.01117,1.13792,1.01462,0}, // 180 < jet pT < 200 GeV
        {0.968882,0.976629,0.973898,1.04963,0.954688,1.04254,1.07817,0}, // 200 < jet pT < 300 GeV
        {0.992935,0.961863,0.990883,1.0058,0.989132,0.999268,1.01327,0}, // 300 < jet pT < 500 GeV
        {1.00603,1.01098,1.00943,1.00922,1.00657,0.841018,0.950293,0}}, // 500 < jet pT < 5020 GeV
      // Centrality 50-90%
      {{0.965538,0.977972,1.02026,0.974613,0.892903,1.29593,1.04572,0}, // 120 < jet pT < 140 GeV
        {0.997265,1.03518,1.01878,0.991855,0.994615,0.971291,0.756797,0}, // 140 < jet pT < 160 GeV
        {1.03008,0.995852,0.953414,0.931047,1.00979,1.18266,0.902785,0}, // 160 < jet pT < 180 GeV
        {0.983772,0.972103,0.99782,1.045,0.893182,1.11626,1.32349,0}, // 180 < jet pT < 200 GeV
        {1.01022,1.00437,0.957475,1.03545,1.03446,1.08991,0.994655,0}, // 200 < jet pT < 300 GeV
        {1.00448,0.998795,0.995266,1.01063,0.963836,1.1153,0.85172,0}, // 300 < jet pT < 500 GeV
        {0.967153,1.01262,0.984775,0.935242,1.0216,1.10296,0.942788,0}} // 500 < jet pT < 5020 GeV
    },
    // ============= Paramater 7 =============
    {
      // Centrality 0-10%
      {{-0.058673,-0.0932126,-0.151492,-0.288302,-0.310662,-0.206062,-0.318163,0}, // 120 < jet pT < 140 GeV
        {-0.0315629,-0.141315,-0.106099,-0.114087,-0.493039,-0.3405,-0.250601,0}, // 140 < jet pT < 160 GeV
        {-0.0313927,-0.203033,-0.174878,-0.144545,-0.437651,-0.0530305,-0.0759031,0}, // 160 < jet pT < 180 GeV
        {-0.0866327,-0.124655,-0.14487,-0.379729,-0.0957637,-0.312637,-0.187472,0}, // 180 < jet pT < 200 GeV
        {-0.0396366,-0.0268592,-0.0772596,-0.085883,-0.0973597,-0.191234,-0.201248,0}, // 200 < jet pT < 300 GeV
        {0.014636,-0.0358853,-0.031558,-0.0749704,-0.124465,-0.142409,-0.204452,0}, // 300 < jet pT < 500 GeV
        {0.221224,-0.0268138,0.0229564,0.0817795,-0.204333,0.0370036,0.00745377,0}}, // 500 < jet pT < 5020 GeV
      // Centrality 10-30%
      {{-0.0844119,-0.103214,-0.0493447,-0.146603,-0.147309,-0.301732,-0.948117,0}, // 120 < jet pT < 140 GeV
        {-0.0752601,-0.0891628,-0.12839,-0.0810245,-0.337157,-0.190617,-0.0610419,0}, // 140 < jet pT < 160 GeV
        {-0.0193725,0.00431217,-0.0535768,-0.117715,-0.140928,-0.239555,0.04942,0}, // 160 < jet pT < 180 GeV
        {-0.0162755,-0.0351333,-0.052686,-0.0772256,-0.0482648,-0.060212,-0.213803,0}, // 180 < jet pT < 200 GeV
        {-0.0189542,-0.0313113,-0.0481347,-0.146298,-0.0866199,-0.122743,-0.40011,0}, // 200 < jet pT < 300 GeV
        {-0.0427452,-0.0500662,-0.0439368,-0.0676264,-0.125509,-0.0603649,-0.106172,0}, // 300 < jet pT < 500 GeV
        {-0.0249303,-0.0305641,-0.0207505,-0.095009,-0.0108145,-0.144007,-0.166902,0}}, // 500 < jet pT < 5020 GeV
      // Centrality 30-50%
      {{-0.0914843,-0.0303363,-0.0661675,-0.149083,-0.25767,-0.351025,-0.088506,0}, // 120 < jet pT < 140 GeV
        {-0.0284644,0.03021,-0.0700568,-0.167265,-0.126749,-0.0609853,-0.439125,0}, // 140 < jet pT < 160 GeV
        {0.0465799,0.0155869,-0.0697517,-0.0729985,-0.133521,-0.265317,0.0709941,0}, // 160 < jet pT < 180 GeV
        {0.0583188,-0.0803255,-0.171381,-0.0763324,-0.126501,-0.364182,-0.244042,0}, // 180 < jet pT < 200 GeV
        {0.0381975,0.00163737,0.00540972,-0.195958,0.0261757,-0.206021,-0.303555,0}, // 200 < jet pT < 300 GeV
        {-0.0087607,0.0514275,-0.0145145,-0.061833,-0.0451933,-0.115978,-0.0777445,0}, // 300 < jet pT < 500 GeV
        {-0.017943,-0.0460604,-0.0493589,-0.0676197,-0.0955639,0.286652,0.17345,0}}, // 500 < jet pT < 5020 GeV
      // Centrality 50-90%
      {{0.047186,-0.0158211,-0.145416,-0.0579285,0.0952161,-0.817989,-0.28883,0}, // 120 < jet pT < 140 GeV
        {-0.0155622,-0.119086,-0.110428,-0.0529025,-0.112723,-0.0567542,0.326811,0}, // 140 < jet pT < 160 GeV
        {-0.0887265,-0.0318222,0.0298458,0.0646184,-0.0667684,-0.42001,0.108212,0}, // 160 < jet pT < 180 GeV
        {-0.0137232,0.0199495,-0.0484171,-0.182669,0.116881,-0.540842,-0.834324,0}, // 180 < jet pT < 200 GeV
        {-0.0515661,-0.0446393,0.0126578,-0.141043,-0.204915,-0.218985,-0.096782,0}, // 200 < jet pT < 300 GeV
        {-0.0275844,-0.024644,-0.0362794,-0.0749548,0.0580584,-0.33525,0.104916,0}, // 300 < jet pT < 500 GeV
        {0.062594,-0.0288147,0.0292426,0.0812891,-0.0696793,-0.418144,0.0566424,0}} // 500 < jet pT < 5020 GeV
    }
  };
  
  // Copy the input values to the class array
  for(int iParameter = 0; iParameter < kMaxParameters; iParameter++){
    for(int iCentrality = 0; iCentrality < kNCentralityBins; iCentrality++){
      for(int iJetPt = 0; iJetPt < kNJetPtBins; iJetPt++){
        for(int iTrackPt = 0; iTrackPt < kNTrackPtBins; iTrackPt++){
          fMonteCarloParameter[iParameter][iCentrality][iJetPt][iTrackPt] = particleDensityPtBinnedMonteCarloParameters[iParameter][iCentrality][iJetPt][iTrackPt];
        } // Track pT loop
      } // Jet pT loop
    } // Centrality loop
  } // Parameter loop
  
}

/*
 * Find a bin index from an array
 */
int ReflectedConeWeight::FindBinIndex(const double* array, const int nBins, const double value) const{
  
  // If the value is below the lowest index, return -1 to show an error
  if(value < array[0]) return -1;
  
  // Find the value from the arrey and return the bin index
  for(int iBin = 0; iBin < nBins; iBin++){
    if(value < array[iBin+1]) return iBin;
  }
  
  // If the value is higher than the upper bin border, return -1 to show an error
  return -1;
}


/*
 * Find centrality bin index
 */
int ReflectedConeWeight::FindCentralityBin(const double centrality) const{
  return FindBinIndex(kCentralityBinBorders, kNCentralityBins, centrality);
}

/*
 * Find jet pT bin index
 */
int ReflectedConeWeight::FindJetPtBin(const double jetPt) const{
  return FindBinIndex(kJetPtBinBorders, kNJetPtBins, jetPt);
}

/*
 * Find track pT bin index
 */
int ReflectedConeWeight::FindTrackPtBin(const double trackPt) const{
  return FindBinIndex(kTrackPtBinBorders, kNTrackPtBins, trackPt);
}

/*
 * Get the weight to be given to the reflected cone track based on a data study
 *
 *  const bool isData = Flag for data. If false, use correction for Monte Carlo
 *  const double deltaR = DeltaR between the track and jet axis
 *  const double centrality = Centrality of the event
 *  const double jetPt = Signal jet pT
 *  const double trackPt = pT of the track in the reflected cone
 */
double ReflectedConeWeight::GetReflectedConeWeight(const bool isData, const double deltaR, const double centrality, const double jetPt, const double trackPt) const{
  if(isData) return GetReflectedConeWeightData(deltaR, centrality, jetPt, trackPt);
  return GetReflectedConeWeightMC(deltaR, centrality, jetPt, trackPt);
}

/*
 * Get the weight to be given to the reflected cone track based on a data study
 *
 *  const double deltaR = DeltaR between the track and jet axis
 *  const double centrality = Centrality of the event
 *  const double jetPt = Signal jet pT
 *  const double trackPt = pT of the track in the reflected cone
 */
double ReflectedConeWeight::GetReflectedConeWeightData(const double deltaR, const double centrality, const double jetPt, const double trackPt) const{
  
  // Find the bin which is used to determine the weight
  const int iCentrality = FindCentralityBin(centrality);
  const int iJetPt = FindJetPtBin(jetPt);
  const int iTrackPt = FindTrackPtBin(trackPt);
  
  // If we are out of bounds in some of the arrays, do not apply weight
  if(iCentrality == -1 || iJetPt == -1 || iTrackPt == -1) return 1;
  
  double relativeChange34, relativeChange06;
  double fractionOf34, fractionOf06;
  
  // If track pT is above 2.5 GeV, only weight by general shape. The kink is not important in this case.
  // Also, if we are before the kink region, use the weight by the general shape
  if(iTrackPt > 2.5 || deltaR < 0.34){
    
    // Find what the relative change up until 0.34 is
    relativeChange34 = fSignalConeMainShape[iCentrality][iJetPt][iTrackPt] - fReflectedConeShape[iCentrality][iJetPt][iTrackPt];
    
    // Find what fraction of this change we need to apply
    fractionOf34 = deltaR / 0.34;
    
    // Return the weight besed the the relative change and the fraction of it we need to apply
    return 1 - (relativeChange34 * fractionOf34);
    
  } else {
    // This is the kink region for low pT tracks
    
    // Find what the relative change up until 0.34 is
    relativeChange34 = fSignalConeMainShape[iCentrality][iJetPt][iTrackPt] - fReflectedConeShape[iCentrality][iJetPt][iTrackPt];
    
    // Find what the relative change from 0.34 to deltaR is
    relativeChange06 = fSignalConeKink[iCentrality][iJetPt][iTrackPt] - (1 + (fReflectedConeShape[iCentrality][iJetPt][iTrackPt]-1) * (0.06/0.34));
    
    // Find the fraction of the kink change we need to apply
    fractionOf06 = (deltaR - 0.34) / 0.06;
    
    // Return the weight based on the relative weight up to the kink and the kink weight
    return 1 - (relativeChange34 + relativeChange06*fractionOf06);
    
  }
  
}

/*
 * Get the weight to be given to the reflected cone track based on a MC study
 *
 *  const double deltaR = DeltaR between the track and jet axis
 *  const double centrality = Centrality of the event
 *  const double jetPt = Signal jet pT
 *  const double trackPt = pT of the track in the reflected cone
 */
double ReflectedConeWeight::GetReflectedConeWeightMC(const double deltaR, const double centrality, const double jetPt, const double trackPt) const{
  
  // Find the bin which is used to determine the weight
  const int iCentrality = FindCentralityBin(centrality);
  const int iJetPt = FindJetPtBin(jetPt);
  const int iTrackPt = FindTrackPtBin(trackPt);
  
  // If we are out of bounds in some of the arrays, do not apply weight
  if(iCentrality == -1 || iJetPt == -1 || iTrackPt == -1) return 1;
  
  // Different functional form for weight function for the high track pT bin
  if(iTrackPt == kNTrackPtBins-1){
    
    // Use exponent and linear for the high track pT
    for(int iParameter = 0; iParameter < 6; iParameter++){
      fMonteCarloExpoLinear->SetParameter(iParameter, fMonteCarloParameter[iParameter][iCentrality][iJetPt][iTrackPt]);
    }
    return fMonteCarloExpoLinear->Eval(deltaR);
    
  } else {
    
    // Use piecewise linear for the lower track pT bins
    for(int iParameter = 0; iParameter < 8; iParameter++){
      fMonteCarloPiecewiseLinear->SetParameter(iParameter, fMonteCarloParameter[iParameter][iCentrality][iJetPt][iTrackPt]);
    }
    return fMonteCarloPiecewiseLinear->Eval(deltaR);
  }
  
}
